{"version":3,"file":"pay-desk.js","sources":["uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/dW5pX21vZHVsZXMvdW5pLXBheS14L3BhZ2VzL3BheS1kZXNrL3BheS1kZXNrLnV2dWU"],"sourcesContent":["<template>\n\t<!-- 自定义收银台页面模式 -->\n\t<view class=\"uni-pay\">\n\t\t<view class=\"mobile-pay-popup\">\n\t\t\t<view class=\"mobile-pay-popup-amount-box\">\n\t\t\t\t<view><text class=\"text\">待支付金额：</text></view>\n\t\t\t\t<view class=\"mobile-pay-popup-amount\"><text class=\"text\">{{ amountFormat(myOptions.getNumber('total_fee')) }}</text></view>\n\t\t\t</view>\n\t\t\t<view class=\"mobile-pay-popup-provider-list\">\n\t\t\t\t<view class=\"uni-list\">\n\n\t\t\t\t\t<view class=\"uni-list-item\" v-if=\"checkProvider('wxpay')\" @click=\"createOrderByProvider('wxpay')\">\n\t\t\t\t\t\t<view class=\"uni-list-item__container container--right\">\n\t\t\t\t\t\t\t<view class=\"uni-list-item__header\">\n\t\t\t\t\t\t\t\t<image :src=\"insideData.getJSON('images')!['wxpay']\" class=\"image\"></image>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view class=\"uni-list-item__content uni-list-item__content--center\">\n\t\t\t\t\t\t\t\t<text class=\"text\">微信支付</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"arrowright\"></view>\n\t\t\t\t\t</view>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<!-- 挂载支付组件 -->\n\t\t<uni-pay ref=\"payRef\" height=\"450px\" :to-success-page=\"false\" @mounted=\"onMounted\" @success=\"onSuccess\" @fail=\"onFail\" @cancel=\"onCancel\"></uni-pay>\n\t</view>\n</template>\n\n<script lang=\"uts\">\n\timport { objectAssign } from \"../../js_sdk/js_sdk\"\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tmyOptions: {\n\t\t\t\t\ttotal_fee: \"\",\n\t\t\t\t} as UTSJSONObject,\n\t\t\t\tinsideData: {\n\t\t\t\t\tcurrentProviders: [] as Array<string>,\n\t\t\t\t\timages: {\n\t\t\t\t\t\talipay: \"\",\n\t\t\t\t\t\twxpay: \"\"\n\t\t\t\t\t} as UTSJSONObject\n\t\t\t\t} as UTSJSONObject, // uni-pay组件mounted事件获得的数据\n\t\t\t\tadpid: \"\", // 广告id\n\t\t\t\treturn_url: \"\", // 支付成功后点击查看订单跳转的订单详情页面地址\n\t\t\t\tmain_color: \"\", // 支付成功页面的主色调\n\t\t\t}\n\t\t},\n\t\t// 监听 - 页面每次【加载时】执行(如：前进)\n\t\tonLoad(options) {\n\t\t\tlet optionsStr = options['options'] as string | null;\n\t\t\tif (optionsStr != null && optionsStr != \"\") {\n\t\t\t\tlet newOptions = JSON.parse(decodeURI(optionsStr)!) as UTSJSONObject;\n\t\t\t\tthis.myOptions = newOptions as UTSJSONObject;\n\t\t\t}\n\t\t\tuni.__f__('log','at uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue:72','myOptions: ', this.myOptions)\n\t\t},\n\t\t// 监听 - 页面【首次渲染完成时】执行。注意如果渲染速度快，会在页面进入动画完成前触发\n\t\tonReady() { },\n\t\t// 监听 - 页面每次【显示时】执行(如：前进和返回) (页面每次出现在屏幕上都触发，包括从下级页面点返回露出当前页面)\n\t\tonShow() { },\n\t\t// 监听 - 页面每次【隐藏时】执行(如：返回)\n\t\tonHide() { },\n\t\t// 函数\n\t\tmethods: {\n\t\t\t// 监听 - 支付组件加载完毕事件\n\t\t\tonMounted(insideData : UTSJSONObject) {\n\t\t\t\tthis.insideData['currentProviders'] = insideData.getArray('currentProviders') as Array<string>;\n\t\t\t\tthis.insideData['images'] = insideData.getJSON('images') as UTSJSONObject;\n\t\t\t},\n\t\t\t// 发起支付\n\t\t\tcreateOrder(data : UTSJSONObject) {\n\t\t\t\tthis.myOptions = objectAssign(this.myOptions, data);\n\t\t\t\tconst payInstance = this.$refs[\"payRef\"] as UniPayComponentPublicInstance;\n\t\t\t\tpayInstance.createOrder(this.myOptions);\n\t\t\t},\n\t\t\t// 根据provider发起支付\n\t\t\tcreateOrderByProvider(provider : string) {\n\t\t\t\tthis.createOrder({\n\t\t\t\t\tprovider\n\t\t\t\t})\n\t\t\t},\n\t\t\t// 监听事件 - 支付成功\n\t\t\tonSuccess(res : UTSJSONObject) {\n\t\t\t\tlet out_trade_no = res['out_trade_no'] as string;\n\t\t\t\tlet pay_order = res.getJSON('pay_order') as UTSJSONObject;\n\t\t\t\tlet order_no = pay_order['order_no'] as string;\n\t\t\t\t//let pay_date = pay_order['pay_date'] as string;\n\t\t\t\tlet total_fee = pay_order.getNumber('total_fee');\n\t\t\t\tif (total_fee == null) {\n\t\t\t\t\ttotal_fee = 0;\n\t\t\t\t}\n\t\t\t\tlet return_url = this.return_url as string;\n\t\t\t\tlet adpid = this.adpid as string;\n\t\t\t\tlet main_color = this.main_color as string;\n\n\t\t\t\tuni.__f__('log','at uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue:113','success: ', res);\n\t\t\t\tlet user_order_success = res.getBoolean('user_order_success');\n\t\t\t\tif (user_order_success != null && user_order_success != true) {\n\t\t\t\t\t// 代表用户已付款，且你自己写的回调成功并正确执行了\n\t\t\t\t\tuni.redirectTo({\n\t\t\t\t\t\turl: `/uni_modules/uni-pay-x/pages/success/success?out_trade_no=${out_trade_no}&order_no=${order_no}&total_fee=${total_fee}&adpid=${adpid}&return_url=${return_url}&main_color=${main_color}`\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// 代表用户已付款，但你自己写的回调执行失败（通常是因为你的回调代码有问题）\n\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 监听事件 - 支付失败\n\t\t\tonFail(err : RequestPaymentFail) {\n\t\t\t\tuni.__f__('log','at uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue:127','fail: ', err)\n\n\t\t\t},\n\t\t\t// 监听事件 - 取消支付\n\t\t\tonCancel(err : RequestPaymentFail) {\n\t\t\t\tuni.__f__('log','at uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue:132','cancel: ', err)\n\n\t\t\t},\n\t\t\tamountFormat(totalFee : number | null) :string{\n\t\t\t\tif (totalFee == null) {\n\t\t\t\t\treturn \"0\";\n\t\t\t\t} else {\n\t\t\t\t\treturn (totalFee / 100).toFixed(2)\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 检测provider\n\t\t\tcheckProvider(provider : string) : boolean {\n\t\t\t\tlet currentProviders = this.insideData.getArray<string>('currentProviders');\n\t\t\t\treturn currentProviders != null && currentProviders.indexOf(provider) > -1 ? true : false;\n\t\t\t}\n\t\t},\n\t\t// 监听器\n\t\twatch: {\n\n\t\t},\n\t\t// 计算属性\n\t\tcomputed: {\n\n\t\t}\n\t}\n</script>\n<style lang=\"scss\" scoped>\n\t.uni-pay{\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tbackground-color: #f3f3f3;\n\t}\n\t.mobile-pay-popup {\n\t\tflex: 1;\n\t\t.mobile-pay-popup-amount-box {\n\t\t\tbackground-color: #ffffff;\n\t\t\tpadding: 15px;\n\n\t\t\t.mobile-pay-popup-amount {\n\t\t\t\tmargin-top: 10px;\n\n\t\t\t\t.text {\n\t\t\t\t\tcolor: #e43d33;\n\t\t\t\t\tfont-size: 30px;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.mobile-pay-popup-provider-list {\n\t\t\tbackground-color: #ffffff;\n\t\t\tmargin-top: 10px;\n\n\t\t\t.uni-list {\n\t\t\t\tdisplay: flex;\n\t\t\t\tbackground-color: #fff;\n\t\t\t\tposition: relative;\n\t\t\t\tflex-direction: column;\n\n\t\t\t\t.uni-list-item {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\tjustify-content: space-between;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tbackground-color: #fff;\n\t\t\t\t\tflex-direction: row;\n\t\t\t\t\tborder-bottom: 1px solid #f8f8f8;\n\n\n\n\n\n\t\t\t\t\t&:hover {\n\t\t\t\t\t\tbackground-color: #f1f1f1;\n\t\t\t\t\t}\n\n\t\t\t\t\t.uni-list-item__container {\n\t\t\t\t\t\tposition: relative;\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tflex-direction: row;\n\t\t\t\t\t\tpadding: 12px 15px;\n\t\t\t\t\t\tpadding-left: 15px;\n\t\t\t\t\t\tflex: 1;\n\t\t\t\t\t\toverflow: hidden;\n\n\t\t\t\t\t\t.uni-list-item__header {\n\t\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\t\tflex-direction: row;\n\t\t\t\t\t\t\talign-items: center;\n\n\t\t\t\t\t\t\t.image {\n\t\t\t\t\t\t\t\twidth: 26px;\n\t\t\t\t\t\t\t\theight: 26px;\n\t\t\t\t\t\t\t\tmargin-right: 9px;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t.container--right {\n\t\t\t\t\t\tpadding-right: 0;\n\t\t\t\t\t}\n\n\t\t\t\t\t.uni-list-item__content {\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tpadding-right: 8px;\n\t\t\t\t\t\tflex: 1;\n\t\t\t\t\t\tflex-direction: column;\n\t\t\t\t\t\tjustify-content: space-between;\n\t\t\t\t\t\toverflow: hidden;\n\n\t\t\t\t\t\t.text {\n\t\t\t\t\t\t\tcolor: #3b4144;\n\t\t\t\t\t\t\tfont-size: 14px;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t.uni-list-item__content--center {\n\t\t\t\t\t\tjustify-content: center;\n\t\t\t\t\t}\n\n\t\t\t\t\t.arrowright {\n\t\t\t\t\t\tborder-top: 1px solid #bbbbbb;\n\t\t\t\t\t\tborder-right: 1px solid #bbbbbb;\n\t\t\t\t\t\twidth: 8px;\n\t\t\t\t\t\theight: 8px;\n\t\t\t\t\t\tmargin-right: 15px;\n\t\t\t\t\t\ttransform: rotate(45deg);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</style>\n","import MiniProgramPage from 'W:/Workplace/2.小程序/lihai-app/uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","uni","objectAssign"],"mappings":";;;AA8CC,MAAA,YAAeA,8BAAA;AAAA,EACd,OAAI;AACH,WAAO;AAAA,MACN,WAAW,IAAA,cAAA;AAAA,QACV,WAAW;AAAA,OACM;AAAA,MAClB,YAAY,IAAA,cAAA;AAAA,QACX,kBAAkB,CAAmB;AAAA,QACrC,QAAQ,IAAA,cAAA;AAAA,UACP,QAAQ;AAAA,UACR,OAAO;AAAA,SACS;AAAA,OACA;AAAA,MAClB,OAAO;AAAA,MACP,YAAY;AAAA,MACZ,YAAY;AAAA;AAAA;EAEb;AAAA;AAAA,EAED,OAAO,SAAO;AACb,QAAI,aAAa,QAAQ,SAAS;AAClC,QAAI,cAAc,QAAQ,cAAc,IAAI;AAC3C,UAAI,aAAa,IAAA,KAAK,MAAM,UAAU,UAAU,CAAE;AAClD,WAAK,YAAY;AAAA,IAClB;AACAC,kBAAG,MAAC,MAAM,OAAM,4DAA2D,eAAe,KAAK,SAAS;AAAA,EACxG;AAAA;AAAA,EAED;EAAa;AAAA;AAAA,EAEb;EAAY;AAAA;AAAA,EAEZ;EAAY;AAAA;AAAA,EAEZ,SAAS;AAAA;AAAA,IAER,UAAU,YAA0B;AACnC,WAAK,WAAW,kBAAkB,IAAI,WAAW,SAAS,kBAAkB;AAC5E,WAAK,WAAW,QAAQ,IAAI,WAAW,QAAQ,QAAQ;AAAA,IACvD;AAAA;AAAA,IAED,YAAY,MAAoB;AAC/B,WAAK,YAAYC,kCAAY,aAAC,KAAK,WAAW,IAAI;AAClD,YAAM,cAAc,KAAK,MAAM,QAAQ;AACvC,kBAAY,YAAY,KAAK,SAAS;AAAA,IACtC;AAAA;AAAA,IAED,sBAAsB,UAAiB;AACtC,WAAK,YAAY,IAAA,cAAA;AAAA,QAChB;AAAA,MACA,CAAA,CAAA;AAAA,IACD;AAAA;AAAA,IAED,UAAU,KAAmB;AAC5B,UAAI,eAAe,IAAI,cAAc;AACrC,UAAI,YAAY,IAAI,QAAQ,WAAW;AACvC,UAAI,WAAW,UAAU,UAAU;AAEnC,UAAI,YAAY,UAAU,UAAU,WAAW;AAC/C,UAAI,aAAa,MAAM;AACtB,oBAAY;AAAA,MACb;AACA,UAAI,aAAa,KAAK;AACtB,UAAI,QAAQ,KAAK;AACjB,UAAI,aAAa,KAAK;AAEtBD,oBAAG,MAAC,MAAM,OAAM,6DAA4D,aAAa,GAAG;AAC5F,UAAI,qBAAqB,IAAI,WAAW,oBAAoB;AAC5D,UAAI,sBAAsB,QAAQ,sBAAsB,MAAM;AAE7DA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK,6DAA6D,YAAY,aAAa,QAAQ,cAAc,SAAS,UAAU,KAAK,eAAe,UAAU,eAAe,UAAU;AAAA,QAC3L,CAAA;AAAA,MAIF;AAAA,IACA;AAAA;AAAA,IAED,OAAO,KAAwB;AAC9BA,oBAAG,MAAC,MAAM,OAAM,6DAA4D,UAAU,GAAG;AAAA,IAEzF;AAAA;AAAA,IAED,SAAS,KAAwB;AAChCA,oBAAG,MAAC,MAAM,OAAM,6DAA4D,YAAY,GAAG;AAAA,IAE3F;AAAA,IACD,aAAa,WAAwB,MAAA;AACpC,UAAI,YAAY,MAAM;AACrB,eAAO;AAAA,MACN,OAAK;AACN,gBAAQ,WAAW,KAAK,QAAQ,CAAC;AAAA,MAClC;AAAA,IACA;AAAA;AAAA,IAED,cAAc,UAAiB;AAC9B,UAAI,mBAAmB,KAAK,WAAW,SAAiB,kBAAkB;AAC1E,aAAO,oBAAoB,QAAQ,iBAAiB,QAAQ,QAAQ,IAAI,KAAK,OAAO;AAAA,IACrF;AAAA,EACA;AAAA;AAAA,EAED,OAAO,CAEN;AAAA;AAAA,EAED,UAAU,CAEV;CACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1JD,GAAG,WAAW,eAAe;"}
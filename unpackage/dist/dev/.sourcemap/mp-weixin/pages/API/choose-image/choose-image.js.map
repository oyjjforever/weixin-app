{"version":3,"file":"choose-image.js","sources":["pages/API/choose-image/choose-image.uvue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvQVBJL2Nob29zZS1pbWFnZS9jaG9vc2UtaW1hZ2UudXZ1ZQ"],"sourcesContent":["<template>\r\n\r\n\r\n\r\n    <page-head :title=\"title\"></page-head>\r\n    <view class=\"uni-common-mt\">\r\n      <view class=\"uni-list\">\r\n        <view class=\"uni-list-cell cell-pd\">\r\n          <text class=\"uni-list-cell-left uni-label\">\r\n            图片来源\r\n          </text>\r\n          <view class=\"uni-list-cell-right\" @click=\"chooseImageSource\">\r\n            <text class=\"click-t\">{{sourceType[sourceTypeIndex]}}</text>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"uni-list-cell cell-pd\">\r\n          <text class=\"uni-list-cell-left uni-label\">\r\n            图片质量\r\n          </text>\r\n          <view class=\"uni-list-cell-right\" @click=\"chooseImageType\">\r\n            <text class=\"click-t\">{{sizeType[sizeTypeIndex]}}</text>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"uni-list-cell cell-pd\">\r\n          <text class=\"uni-list-cell-left uni-label\">\r\n            数量限制\r\n          </text>\r\n          <view class=\"uni-list-cell-right\">\r\n            <input class=\"click-t\" :value=\"count\" type=\"number\" :maxlength=\"1\" @blur=\"chooseImageCount\" />\r\n          </view>\r\n        </view>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        <view class=\"uni-list-cell cell-pd\">\r\n          <text class=\"uni-list-cell-left uni-label\">\r\n            图像裁剪\r\n          </text>\r\n          <view class=\"uni-list-cell-right\">\r\n            <switch :checked=\"isCrop\" @change=\"switchCrop\"></switch>\r\n          </view>\r\n        </view>\r\n        <view ref=\"cropOptionNode\" class=\"crop-option\"\r\n          :style=\"{'height':isCrop?'200px':'0px','margin-bottom':isCrop?'11px':'0px'}\">\r\n          <view class=\"uni-list-cell cell-pd\">\r\n            <view class=\"uni-list-cell-left item_width\">\r\n              图片质量(%)\r\n            </view>\r\n            <view class=\"uni-list-cell-right\">\r\n              <input :value=\"cropPercent\" @confirm=\"cropPercentConfim\" type=\"number\" maxlength=\"-1\" />\r\n            </view>\r\n          </view>\r\n          <view class=\"uni-list-cell cell-pd\">\r\n            <view class=\"uni-list-cell-left item_width\">\r\n              裁剪宽度(px)\r\n            </view>\r\n            <view class=\"uni-list-cell-right\">\r\n              <input :value=\"cropWidth\" @confirm=\"cropWidthConfim\" type=\"number\" maxlength=\"-1\" />\r\n            </view>\r\n          </view>\r\n          <view class=\"uni-list-cell cell-pd\">\r\n            <view class=\"uni-list-cell-left item_width\">\r\n              裁剪高度(px)\r\n            </view>\r\n            <view class=\"uni-list-cell-right\">\r\n              <input :value=\"cropHeight\" @confirm=\"cropHeightConfim\" type=\"number\" maxlength=\"-1\" />\r\n            </view>\r\n          </view>\r\n          <view class=\"uni-list-cell cell-pd\">\r\n            <view class=\"uni-list-cell-left item_width\">\r\n              保留原宽高\r\n            </view>\r\n            <view class=\"uni-list-cell-right\">\r\n              <switch :checked=\"cropResize\" @change=\"cropResizeChange\"></switch>\r\n            </view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n\r\n      <view class=\"uni-list list-pd\" style=\"padding: 15px;\">\r\n        <view class=\"uni-flex\" style=\"margin-bottom: 10px;\">\r\n          <view class=\"uni-list-cell-left\">点击可预览选好的图片</view>\r\n          <view style=\"margin-left: auto;\">\r\n            <text class=\"click-t\">{{imageList.length}}/{{count}}</text>\r\n          </view>\r\n        </view>\r\n        <view class=\"uni-flex\" style=\"flex-wrap: wrap;\">\r\n          <view v-for=\"(image,index) in imageList\" :key=\"index\" class=\"uni-uploader__input-box\" style=\"border: 0;\">\r\n            <image style=\"width: 104px; height: 104px;\" :src=\"image\" :data-src=\"image\" @tap=\"previewImage(index)\">\r\n            </image>\r\n            <image src=\"/static/plus.png\" class=\"image-remove\" @click=\"removeImage(index)\"></image>\r\n          </view>\r\n          <image class=\"uni-uploader__input-box\" @tap=\"chooseImage\" src=\"/static/plus.png\"></image>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n\r\n\r\n</template>\r\n\r\n<script lang=\"uts\">\r\n  var sourceTypeArray = [\r\n    ['camera'],\r\n    ['album'],\r\n    ['camera', 'album']\r\n  ]\r\n  var sizeTypeArray = [\r\n    ['compressed'],\r\n    ['original'],\r\n    ['compressed', 'original']\r\n  ]\r\n  var orientationTypeArray = [\r\n    'portrait',\r\n    'landscape',\r\n    'auto'\r\n  ]\r\n  var albumModeTypeArray = [\r\n    \"custom\",\r\n    \"system\"\r\n  ]\r\n  export default {\r\n    data() {\r\n      return {\r\n        title: 'chooseImage',\r\n        imageList: [] as Array<string>,\r\n        sourceTypeIndex: 2,\r\n        sourceType: ['拍照', '相册', '拍照或相册'],\r\n        sizeTypeIndex: 2,\r\n        sizeType: ['压缩', '原图', '压缩或原图'],\r\n        orientationTypeIndex: 0,\r\n        orientationType: ['竖屏', '横屏', '自动'],\r\n        albumModeTypeIndex:0,\r\n        albumModeType:[\"自定义相册\",\"系统相册\"],\r\n        count: 9,\r\n        isCrop: false,\r\n        cropPercent: 80,\r\n        cropWidth: 100,\r\n        cropHeight: 100,\r\n        cropResize: false\r\n      }\r\n    },\r\n    onHide() {\r\n      uni.__f__('log','at pages/API/choose-image/choose-image.uvue:163',\"Page Hide\");\r\n    },\r\n    onUnload() {\r\n      this.imageList = [];\r\n      this.sourceTypeIndex = 2\r\n      this.sourceType = ['拍照', '相册', '拍照或相册']\r\n      this.sizeTypeIndex = 2\r\n      this.sizeType = ['压缩', '原图', '压缩或原图']\r\n      this.orientationTypeIndex = 0\r\n      this.orientationType = ['竖屏', '横屏', '自动']\r\n    },\r\n    methods: {\r\n      cropHeightConfim(e : InputConfirmEvent) {\r\n        let value = parseInt(e.detail.value)\r\n        if (value > 0) {\r\n          this.cropHeight = value\r\n        } else {\r\n          uni.showToast({\r\n            position: \"bottom\",\r\n            title: \"裁剪高度需要大于0\"\r\n          })\r\n        }\r\n      },\r\n      cropWidthConfim(e : InputConfirmEvent) {\r\n        let value = parseInt(e.detail.value)\r\n        if (value > 0) {\r\n          this.cropWidth = value\r\n        } else {\r\n          uni.showToast({\r\n            position: \"bottom\",\r\n            title: \"裁剪宽度需要大于0\"\r\n          })\r\n        }\r\n      },\r\n      cropPercentConfim(e : InputConfirmEvent) {\r\n        let value = parseInt(e.detail.value)\r\n        if (value > 0 && value <= 100) {\r\n          this.cropPercent = value\r\n        } else {\r\n          uni.showToast({\r\n            position: \"bottom\",\r\n            title: \"请输入0~100之间的值\"\r\n          })\r\n        }\r\n      },\r\n      albumModeChange(){\r\n        uni.showActionSheet({\r\n          itemList: this.albumModeType,\r\n          success: (e) => {\r\n            this.albumModeTypeIndex = e.tapIndex\r\n          }\r\n        })\r\n      },\r\n      cropResizeChange(e : UniSwitchChangeEvent) {\r\n        this.cropResize = e.detail.value\r\n      },\r\n      switchCrop(e : UniSwitchChangeEvent) {\r\n        this.isCrop = e.detail.value\r\n      },\r\n      removeImage(index : number) {\r\n        this.imageList.splice(index, 1)\r\n      },\r\n      chooseImageSource() {\r\n        uni.showActionSheet({\r\n          itemList: ['拍照', '相册', '拍照或相册'],\r\n          success: (e) => {\r\n            this.sourceTypeIndex = e.tapIndex\r\n          }\r\n        })\r\n      },\r\n      chooseImageType() {\r\n        uni.showActionSheet({\r\n          itemList: ['压缩', '原图', '压缩或原图'],\r\n          success: (e) => {\r\n            this.sizeTypeIndex = e.tapIndex\r\n          }\r\n        })\r\n      },\r\n      chooseOrientationType(){\r\n        uni.showActionSheet({\r\n          itemList: ['竖屏', '横屏', '自动'],\r\n          success: (e) => {\r\n            this.orientationTypeIndex = e.tapIndex\r\n          }\r\n        })\r\n      },\r\n      chooseImageCount(event : InputBlurEvent) {\r\n        let count = parseInt(event.detail.value)\r\n        if (count < 0) {\r\n          uni.showToast({\r\n            position: \"bottom\",\r\n            title: \"图片数量应该大于0\"\r\n          })\r\n          return\r\n        }\r\n        this.count = count\r\n      },\r\n      chooseImage: function () {\r\n        if (this.imageList.length >= this.count) {\r\n          uni.showToast({\r\n            position: \"bottom\",\r\n            title: `已经有 ${this.count} 张图片了，请删除部分图片之后重新选择`\r\n          })\r\n          return\r\n        }\r\n        uni.chooseImage({\r\n          sourceType: sourceTypeArray[this.sourceTypeIndex],\r\n          sizeType: sizeTypeArray[this.sizeTypeIndex],\r\n          crop: this.isCrop ? { \"quality\": this.cropPercent, \"width\": this.cropWidth, \"height\": this.cropHeight, \"resize\": this.cropResize } as ChooseImageCropOptions : null,\r\n          count: this.count - this.imageList.length,\r\n\r\n\r\n\r\n\r\n\r\n\r\n          success: (res) => {\r\n            this.imageList = this.imageList.concat(res.tempFilePaths);\r\n            uni.__f__('log','at pages/API/choose-image/choose-image.uvue:281',\"this.imageList: \",this.imageList)\r\n          },\r\n          fail: (err) => {\r\n            uni.__f__('log','at pages/API/choose-image/choose-image.uvue:284',\"err: \", JSON.stringify(err));\r\n            uni.showToast({\r\n              title:\"choose image error.code:\" + err.errCode+\";message:\"+err.errMsg,\r\n              position:\"bottom\"\r\n            })\r\n          }\r\n        })\r\n      },\r\n      previewImage: function (index : number) {\r\n        uni.previewImage({\r\n          current: index,\r\n          urls: this.imageList\r\n        })\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n  .cell-pd {\r\n    padding: 11px 15px;\r\n  }\r\n\r\n  .click-t {\r\n    color: darkgray;\r\n  }\r\n\r\n  .list-pd {\r\n    margin-top: 25px;\r\n  }\r\n\r\n  .uni-uploader__input-box {\r\n    margin: 5px;\r\n    width: 104px;\r\n    height: 104px;\r\n    border: 1px solid #D9D9D9;\r\n  }\r\n\r\n  .uni-uploader__input {\r\n    position: absolute;\r\n    z-index: 1;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    opacity: 0;\r\n  }\r\n\r\n  .image-remove {\r\n    transform: rotate(45deg);\r\n    width: 25px;\r\n    height: 25px;\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    border-radius: 13px;\r\n    background-color: rgba(200, 200, 200, 0.8);\r\n  }\r\n\r\n  .item_width {\r\n    width: 130px;\r\n  }\r\n\r\n  .crop-option {\r\n    margin-left: 11px;\r\n    margin-right: 11px;\r\n    border-radius: 11px;\r\n    background-color: #eee;\r\n    transition-property: height, margin-bottom;\r\n    transition-duration: 200ms;\r\n  }\r\n</style>\r\n","import MiniProgramPage from 'W:/Workplace/2.小程序/lihai-app/pages/API/choose-image/choose-image.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","uni"],"mappings":"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"}
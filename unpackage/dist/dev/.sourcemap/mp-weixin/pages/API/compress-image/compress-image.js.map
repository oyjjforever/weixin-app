{"version":3,"file":"compress-image.js","sources":["pages/API/compress-image/compress-image.uvue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvQVBJL2NvbXByZXNzLWltYWdlL2NvbXByZXNzLWltYWdlLnV2dWU"],"sourcesContent":["<template>\r\n\r\n\r\n\r\n    <view>\r\n      <page-head :title=\"title\"></page-head>\r\n      <view class=\"uni-padding-wrap\">\r\n        <view class=\"image-container\">\r\n          <image class=\"image\" :src=\"beforeCompressPath\" mode=\"aspectFit\"></image>\r\n          <image class=\"image\" :src=\"afterCompressPath\" mode=\"aspectFit\"></image>\r\n        </view>\r\n        <view class=\"uni-title\">\r\n          <text class=\"uni-subtitle-text\">压缩前图片信息</text>\r\n        </view>\r\n        <text>{{beforeCompressImageInfo}}</text>\r\n        <view class=\"uni-title\">\r\n          <text class=\"uni-subtitle-text\">压缩后图片信息</text>\r\n        </view>\r\n        <text>{{afterCompressImageInfo}}</text>\r\n        <view class=\"uni-btn-v\">\r\n          <button type=\"primary\" @click=\"chooseImage\">从相册中选取待压缩的图片</button>\r\n        </view>\r\n        <view class=\"uni-btn-v\">\r\n          <button type=\"primary\" @click=\"compressImage\">压缩图片</button>\r\n        </view>\r\n      </view>\r\n      <input-data defaultValue=\"80\" title=\"压缩质量，范围0～100，数值越小，质量越低，压缩率越高（仅对jpg有效）\" type=\"number\"\r\n        @confirm=\"onQualityConfirm\"></input-data>\r\n      <input-data title=\"压缩后图片的宽度，单位px\" type=\"string\" @confirm=\"onCompressedWidthConfirm\"></input-data>\r\n      <input-data title=\"压缩后图片的高度，单位px\" type=\"string\" @confirm=\"onCompressedHeightConfirm\"></input-data>\r\n      <input-data defaultValue=\"0\" title=\"旋转度数，范围0～360\" type=\"number\" @confirm=\"onRotateConfirm\"></input-data>\r\n    </view>\r\n\r\n\r\n\r\n</template>\r\n\r\n<script lang=\"uts\">\r\n\r\n\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        title: \"compressImage\",\r\n        beforeCompressImageInfo: \"\",\r\n        afterCompressImageInfo: \"\",\r\n        beforeCompressPath: \"\",\r\n        afterCompressPath: \"\",\r\n        quality: 80,\r\n        compressedWidth: null as number | null,\r\n        compressedHeight: null as number | null,\r\n        rotate: 0,\r\n        // 自动化测试\r\n        imageInfoForTest: null as UTSJSONObject | null,\r\n        imageSrcForTest: '/static/test-image/logo.png'\r\n      }\r\n    },\r\n    methods: {\r\n      compressImage() {\r\n        if (this.beforeCompressPath == \"\") {\r\n          uni.showToast({\r\n            title: \"请先选择图片\",\r\n            icon: \"error\"\r\n          });\r\n          return;\r\n        }\r\n        uni.showLoading({\r\n          title: \"图片压缩中\"\r\n        });\r\n        uni.compressImage({\r\n          src: this.beforeCompressPath,\r\n          quality: this.quality,\r\n          compressedWidth: this.compressedWidth,\r\n          compressedHeight: this.compressedHeight,\r\n          rotate: this.rotate,\r\n          success: (res) => {\r\n            uni.__f__('log','at pages/API/compress-image/compress-image.uvue:78',\"compressImage success\", JSON.stringify(res));\r\n            this.afterCompressPath = res.tempFilePath;\r\n            uni.showToast({\r\n              title: \"压缩成功\",\r\n              icon: null\r\n            });\r\n            uni.getImageInfo({\r\n              src: res.tempFilePath,\r\n              success: (_res) => {\r\n                this.afterCompressImageInfo = `图片宽度: ${_res.width}\\n图片高度: ${_res.height}\\n`;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n              }\r\n            });\r\n          },\r\n          fail: (err) => {\r\n            uni.showModal({\r\n              title: \"压缩图片失败\",\r\n              content: JSON.stringify(err),\r\n              showCancel: false\r\n            });\r\n          },\r\n          complete: (_) => {\r\n            uni.hideLoading();\r\n          }\r\n        });\r\n      },\r\n      chooseImage() {\r\n        uni.chooseImage({\r\n          count: 1,\r\n          sizeType: [\"original\"],\r\n          sourceType: [\"album\"],\r\n          success: (res) => {\r\n            this.beforeCompressPath = res.tempFilePaths[0];\r\n            uni.getImageInfo({\r\n              src: res.tempFilePaths[0],\r\n              success: (_res) => {\r\n                this.beforeCompressImageInfo = `图片宽度: ${_res.width}\\n图片高度: ${_res.height}\\n`;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n              }\r\n            });\r\n          }\r\n        });\r\n      },\r\n      onQualityConfirm(value : number) {\r\n        this.quality = value;\r\n      },\r\n      onCompressedWidthConfirm(value : string) {\r\n        this.compressedWidth = parseInt(value);\r\n      },\r\n      onCompressedHeightConfirm(value : string) {\r\n        this.compressedHeight = parseInt(value);\r\n      },\r\n      onRotateConfirm(value : number) {\r\n        this.rotate = value;\r\n      },\r\n      testCompressImage() {\r\n        uni.compressImage({\r\n          src: this.imageSrcForTest,\r\n          quality: 50,\r\n          compressedWidth: 100,\r\n          compressedHeight: 100,\r\n          success: (res) => {\r\n            uni.getImageInfo({\r\n              src: res.tempFilePath,\r\n              success: (_res) => {\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n              }\r\n            });\r\n          },\r\n          fail: (_) => {\r\n            this.imageInfoForTest = null;\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n  .image {\r\n    flex: 1;\r\n  }\r\n\r\n  .image-container {\r\n    flex-direction: row;\r\n  }\r\n</style>\r\n","import MiniProgramPage from 'W:/Workplace/2.小程序/lihai-app/pages/API/compress-image/compress-image.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","uni"],"mappings":"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"}
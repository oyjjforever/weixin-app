{"version":3,"file":"get-location.js","sources":["pages/API/get-location/get-location.uvue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvQVBJL2dldC1sb2NhdGlvbi9nZXQtbG9jYXRpb24udXZ1ZQ"],"sourcesContent":["<template>\r\n\r\n\r\n\r\n    <page-head :title=\"title\"></page-head>\r\n    <view style=\"padding: 4px\">\r\n      <text class=\"hello-text\">\r\n        定位功能默认调用操作系统定位API实现。也支持三方SDK定位\\n\r\n        部分老款Android手机因gms问题可能导致无法使用系统定位。\\n\r\n        Web、Android、iOS平台，gcj国标、逆地理信息等功能需调用腾讯定位。</text>\r\n    </view>\r\n\r\n    <view class=\"uni-padding-wrap uni-common-mt\">\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n      <view class=\"uni-list-cell-db\">定位类型</view>\r\n      <view class=\"uni-list\">\r\n        <radio-group @change=\"radioChange\">\r\n          <radio class=\"uni-list-cell uni-list-cell-pd\" v-for=\"(item, index) in items\" :key=\"item.value\"\r\n            :class=\"index < items.length - 1 ? 'uni-list-cell-line' : ''\" :value=\"item.value\"\r\n            :checked=\"index === current\">\r\n            {{ item.name }}\r\n          </radio>\r\n        </radio-group>\r\n      </view>\r\n      <view class=\"uni-list-cell uni-list-cell-pd\" style=\"margin-top: 20px\">\r\n        <view class=\"uni-list-cell-db\">高度信息</view>\r\n        <switch :checked=\"altitudeSelect\" @change=\"altitudeChange\" />\r\n      </view>\r\n      <view class=\"uni-list-cell uni-list-cell-pd\">\r\n        <view class=\"uni-list-cell-db\">开启高精度定位</view>\r\n        <switch :checked=\"isHighAccuracySelect\" @change=\"highAccuracySelectChange\" />\r\n      </view>\r\n      <view class=\"uni-list-cell uni-list-cell-pd\">\r\n        <view class=\"uni-list-cell-db\">是否解析地址信息</view>\r\n        <switch :checked=\"geocodeSelect\" @change=\"geocodeChange\" />\r\n      </view>\r\n      <view class=\"get-location-result\">{{ exeRet }}</view>\r\n      <view class=\"uni-btn-v\">\r\n        <button class=\"uni-btn\" type=\"default\" @tap=\"getLocationTap\">\r\n          获取定位\r\n        </button>\r\n      </view>\r\n    </view>\r\n\r\n\r\n\r\n</template>\r\n<script lang=\"uts\">\r\n  type GetLocationType = 'wgs84' | 'gcj02'\r\n  export type LocationItem = { id : string, name : string, provider ?: UniProvider }\r\n  export type ItemType = { value : GetLocationType, name : GetLocationType }\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        title: 'get-location',\r\n        altitudeSelect: false,\r\n        isHighAccuracySelect: false,\r\n        geocodeSelect: false,\r\n        exeRet: '',\r\n        items: [\r\n          {\r\n            value: 'wgs84',\r\n            name: 'wgs84'\r\n          },\r\n          {\r\n            value: 'gcj02',\r\n            name: 'gcj02'\r\n          }\r\n        ] as ItemType[],\r\n        providerList: [] as LocationItem[],\r\n        current: 0,\r\n        currentProvider: 0,\r\n        jest_provider: '',\r\n        jest_type: 'wgs84' as GetLocationType,\r\n        jest_isAltitude: false,\r\n        jest_isGeocode: false,\r\n        jest_isHighAccuracy: false,\r\n        jest_altitude: -1000,\r\n        jest_longitude: 200,\r\n        jest_latitude: 100,\r\n        jest_address: '',\r\n        jest_errCode: 0,\r\n        jest_complete: false\r\n      }\r\n    },\r\n    onLoad: function () {\r\n\r\n\r\n\r\n    },\r\n    methods: {\r\n      getProvider() {\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n      },\r\n      altitudeChange: function (e : UniSwitchChangeEvent) {\r\n        this.altitudeSelect = e.detail.value\r\n      },\r\n      geocodeChange: function (e : UniSwitchChangeEvent) {\r\n        this.geocodeSelect = e.detail.value\r\n      },\r\n      highAccuracySelectChange: function (e : UniSwitchChangeEvent) {\r\n        this.isHighAccuracySelect = e.detail.value\r\n      },\r\n      radioChange(e : UniRadioGroupChangeEvent) {\r\n        for (let i = 0; i < this.items.length; i++) {\r\n          if (this.items[i].value === e.detail.value) {\r\n            this.current = i;\r\n            break;\r\n          }\r\n        }\r\n      },\r\n      radioChangePV(e : UniRadioGroupChangeEvent) {\r\n        for (let i = 0; i < this.providerList.length; i++) {\r\n          if (this.providerList[i].id === e.detail.value) {\r\n            this.currentProvider = i;\r\n            break;\r\n          }\r\n        }\r\n        if (e.detail.value == \"system\") {\r\n          this.current = 0\r\n        } else if (e.detail.value == \"tencent\") {\r\n          this.current = 1\r\n        }\r\n      },\r\n      getLocationTap: function () {\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        uni.showLoading({\r\n          title: '定位中'\r\n        })\r\n        uni.getLocation(({\r\n\r\n\r\n\r\n          type: this.items[this.current].value,\r\n          altitude: this.altitudeSelect,\r\n          isHighAccuracy: this.isHighAccuracySelect,\r\n          geocode: this.geocodeSelect,\r\n          success: (res : any) => {\r\n            uni.hideLoading()\r\n            this.exeRet = JSON.stringify(res)\r\n          },\r\n          fail: (res : any) => {\r\n            uni.hideLoading()\r\n            this.exeRet = JSON.stringify(res)\r\n          },\r\n          complete: (res : any) => {\r\n            uni.hideLoading()\r\n            this.exeRet = JSON.stringify(res)\r\n          }\r\n        }));\r\n      },\r\n\r\n      // 仅用于自动化测试\r\n      jestGetLocation() {\r\n        this.jest_complete = false\r\n        this.jest_errCode = 0\r\n        uni.getLocation(({\r\n\r\n\r\n\r\n          type: this.jest_type,\r\n          altitude: this.jest_isAltitude,\r\n          isHighAccuracy: this.jest_isHighAccuracy,\r\n          geocode: this.jest_isGeocode,\r\n          success: (res) => {\r\n            if (res.address != null) {\r\n              this.jest_address = res.address!\r\n            }\r\n            this.jest_longitude = res.longitude\r\n            this.jest_latitude = res.latitude\r\n            this.jest_altitude = res.altitude\r\n            this.jest_complete = true\r\n          },\r\n          fail: (err) => {\r\n            this.jest_errCode = err.errCode\r\n            this.jest_complete = true\r\n          }\r\n        }));\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n  .get-location-result {\r\n\r\n    word-break: break-all;\r\n\r\n  }\r\n</style>\r\n","import MiniProgramPage from 'W:/Workplace/2.小程序/lihai-app/pages/API/get-location/get-location.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","uni"],"mappings":"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"}
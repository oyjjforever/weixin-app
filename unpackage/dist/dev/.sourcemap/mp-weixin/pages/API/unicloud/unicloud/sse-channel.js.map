{"version":3,"file":"sse-channel.js","sources":["pages/API/unicloud/unicloud/sse-channel.uvue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvQVBJL3VuaWNsb3VkL3VuaWNsb3VkL3NzZS1jaGFubmVsLnV2dWU"],"sourcesContent":["<template>\r\n\r\n\r\n\r\n    <view>\r\n      <page-head :title=\"title\"></page-head>\r\n      <button @click=\"receiveMessage\">接收服务端通知</button>\r\n      <view>\r\n        <view v-for=\"item in messages\">{{item}}</view>\r\n      </view>\r\n    </view>\r\n\r\n\r\n\r\n</template>\r\n\r\n<script lang=\"uts\">\r\n  export default {\r\n    data() {\r\n      return {\r\n        title: '服务端通知通道',\r\n        messages: [] as string[]\r\n      }\r\n    },\r\n    methods: {\r\n      async receiveMessage() {\r\n        this.messages.splice(0, this.messages.length)\r\n        const sseChannel = new uniCloud.SSEChannel()\r\n        sseChannel.on('message', (message?: any | null) => {\r\n          if(typeof message === 'string') {\r\n            this.messages.push(message)\r\n          }\r\n        })\r\n        sseChannel.on('end', (message?: any | null) => {\r\n          if(typeof message === 'string') {\r\n            this.messages.push(message)\r\n          }\r\n        })\r\n        sseChannel.on('open', () => {\r\n          uni.__f__('log','at pages/API/unicloud/unicloud/sse-channel.uvue:40','sseChannel open')\r\n        })\r\n        sseChannel.on('close', () => {\r\n          uni.__f__('log','at pages/API/unicloud/unicloud/sse-channel.uvue:43','sseChannel close')\r\n        })\r\n        sseChannel.on('error', (error: UniCloudError) => {\r\n          uni.__f__('log','at pages/API/unicloud/unicloud/sse-channel.uvue:46','sseChannel error: ' + error.message)\r\n        })\r\n        await sseChannel.open()\r\n        const res = await uniCloud.callFunction({\r\n          name: 'sse',\r\n          data: {\r\n            sseChannel\r\n          }\r\n        } as UniCloudCallFunctionOptions)\r\n        uni.__f__('log','at pages/API/unicloud/unicloud/sse-channel.uvue:55',res)\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n</style>\r\n","import MiniProgramPage from 'W:/Workplace/2.小程序/lihai-app/pages/API/unicloud/unicloud/sse-channel.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","uniCloud","uni"],"mappings":";;AAiBE,MAAA,YAAeA,8BAAA;AAAA,EACb,OAAI;AACF,WAAO;AAAA,MACL,OAAO;AAAA,MACP,UAAU,CAAa;AAAA;EAE1B;AAAA,EACD,SAAS;AAAA,IACD,iBAAc;;AAClB,aAAK,SAAS,OAAO,GAAG,KAAK,SAAS,MAAM;AAC5C,cAAM,aAAa,IAAIC,iBAAS;AAChC,mBAAW,GAAG,WAAW,CAAC,UAAoB,SAAA;AAC5C,cAAG,OAAO,YAAY,UAAU;AAC9B,iBAAK,SAAS,KAAK,OAAO;AAAA,UAC5B;AAAA,QACF,CAAC;AACD,mBAAW,GAAG,OAAO,CAAC,UAAoB,SAAA;AACxC,cAAG,OAAO,YAAY,UAAU;AAC9B,iBAAK,SAAS,KAAK,OAAO;AAAA,UAC5B;AAAA,QACF,CAAC;AACD,mBAAW,GAAG,QAAQ,MAAA;AACpBC,wBAAAA,MAAI,MAAM,OAAM,sDAAqD,iBAAiB;AAAA,QACxF,CAAC;AACD,mBAAW,GAAG,SAAS,MAAA;AACrBA,wBAAAA,MAAI,MAAM,OAAM,sDAAqD,kBAAkB;AAAA,QACzF,CAAC;AACD,mBAAW,GAAG,SAAS,CAAC,UAAoB;AAC1CA,wBAAG,MAAC,MAAM,OAAM,sDAAqD,uBAAuB,MAAM,OAAO;AAAA,QAC3G,CAAC;AACD,cAAM,WAAW;AACjB,cAAM,MAAM,MAAMD,cAAQ,GAAC,aAAa;AAAA,UACtC,MAAM;AAAA,UACN,MAAM,IAAA,cAAA;AAAA,YACJ;AAAA,WACF;AAAA,QAC8B,CAAA;AAChCC,sBAAAA,MAAI,MAAM,OAAM,sDAAqD,GAAG;AAAA,OAC1E;AAAA,IAAA;AAAA,EACF;CACF;;;;;;;;;;;;;;;;;;;;;;;;ACxDF,GAAG,WAAW,eAAe;"}
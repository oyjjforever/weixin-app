{"version":3,"file":"web-view.js","sources":["pages/component/web-view/web-view.uvue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29tcG9uZW50L3dlYi12aWV3L3dlYi12aWV3LnV2dWU"],"sourcesContent":["<template>\r\n  <view class=\"uni-flex-item\">\r\n    <web-view id=\"web-view\" class=\"uni-flex-item\" :style=\"{ 'pointer-events': pointerEvents }\" :src=\"src\"\r\n      :webview-styles=\"webview_styles\" :horizontalScrollBarAccess=\"horizontalScrollBarAccess\" :verticalScrollBarAccess=\"verticalScrollBarAccess\" :bounces=\"bounces\" @message=\"message\" @error=\"error\" @loading=\"loading\"\r\n      @load=\"load\" @download=\"download\" @contentheightchange=\"contentheightchange\" @touchstart=\"touchstart\" @tap=\"tap\">\r\n    </web-view>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  </view>\r\n</template>\r\n\r\n<script lang=\"uts\">\r\n\r\n\r\n\r\n  let webviewElement =  null as UniWebViewElement | null\r\n  export default {\r\n    data() {\r\n      return {\r\n        src: 'https://www.dcloud.io',\r\n        webview_styles: {\r\n          progress: {\r\n            color: '#FF3333'\r\n          }\r\n        },\r\n        webviewContext: null as WebviewContext | null,\r\n        loadError: false,\r\n        horizontalScrollBarAccess: true,\r\n        verticalScrollBarAccess: true,\r\n        bounces: true,\r\n        canGoBack: false,\r\n        canGoForward: false,\r\n        // 自动化测试\r\n        autoTest: false,\r\n        eventLoading: null as UTSJSONObject | null,\r\n        eventLoad: null as UTSJSONObject | null,\r\n        eventError: null as UTSJSONObject | null,\r\n        eventContentHeightChange: null as UTSJSONObject | null,\r\n        pointerEvents: 'auto',\r\n        isTouchEnable: false\r\n      }\r\n    },\r\n    onReady() {\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    },\r\n    onUnload() {\r\n      webviewElement = null;\r\n    },\r\n    methods: {\r\n      getPackageName() : string {\r\n        let packageName : string = \"\"\r\n\r\n\r\n\r\n\r\n\r\n\r\n        return packageName\r\n      },\r\n      isProd() : boolean {\r\n        if (this.getPackageName() == 'io.dcloud.hellouniappx') {\r\n          return true\r\n        }\r\n        return false\r\n      },\r\n      back() {\r\n        webviewElement?.back();\r\n      },\r\n      forward() {\r\n        webviewElement?.forward();\r\n      },\r\n      reload() {\r\n        webviewElement?.reload();\r\n      },\r\n      stop() {\r\n        webviewElement?.stop();\r\n      },\r\n      nativeToWeb() {\r\n        webviewElement?.evalJS(\"alert('hello uni-app x')\");\r\n      },\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n      message(event : UniWebViewMessageEvent) {\r\n        uni.__f__('log','at pages/component/web-view/web-view.uvue:164',JSON.stringify(event.detail));\r\n      },\r\n      error(event : UniWebViewErrorEvent) {\r\n        this.loadError = true\r\n        uni.__f__('log','at pages/component/web-view/web-view.uvue:168',JSON.stringify(event.detail));\r\n        if (this.autoTest) {\r\n          this.eventError = {\r\n            \"tagName\": event.target?.tagName,\r\n            \"type\": event.type,\r\n            \"errCode\": event.detail.errCode,\r\n            \"errMsg\": event.detail.errMsg,\r\n            \"url\": event.detail.url,\r\n            \"fullUrl\": event.detail.fullUrl,\r\n            \"src\": event.detail.src\r\n          };\r\n        }\r\n      },\r\n      loading(event : UniWebViewLoadingEvent) {\r\n        uni.__f__('log','at pages/component/web-view/web-view.uvue:182',JSON.stringify(event.detail));\r\n        if (this.autoTest) {\r\n          this.eventLoading = {\r\n            \"tagName\": event.target?.tagName,\r\n            \"type\": event.type,\r\n            \"src\": event.detail.src\r\n          };\r\n        }\r\n      },\r\n      load(event : UniWebViewLoadEvent) {\r\n        uni.__f__('log','at pages/component/web-view/web-view.uvue:192',JSON.stringify(event.detail));\r\n\r\n\r\n\r\n\r\n        if (this.autoTest) {\r\n          this.eventLoad = {\r\n            \"tagName\": event.target?.tagName,\r\n            \"type\": event.type,\r\n            \"src\": event.detail.src,\r\n            \"url\": event.detail.url,\r\n          };\r\n        }\r\n      },\r\n      download(event : UniWebViewDownloadEvent) {\r\n        uni.__f__('log','at pages/component/web-view/web-view.uvue:207',JSON.stringify(event.detail));\r\n        uni.showModal({\r\n          content: \"下载链接: \" + event.detail.url + \"\\n文件大小: \" + event.detail.contentLength / 1024 + \"KB\",\r\n          showCancel: false\r\n        });\r\n      },\r\n      contentheightchange(event : UniWebViewContentHeightChangeEvent) {\r\n        uni.__f__('log','at pages/component/web-view/web-view.uvue:214',JSON.stringify(event.detail));\r\n        this.eventContentHeightChange = {\r\n          \"tagName\": event.target?.tagName,\r\n          \"type\": event.type,\r\n          \"isValidHeight\": event.detail.height > 0\r\n        };\r\n      },\r\n      confirm(event : UniInputConfirmEvent) {\r\n        let url = event.detail.value;\r\n        if (!url.startsWith('https://') && !url.startsWith('http://')) {\r\n          url = 'https://' + url;\r\n        }\r\n        this.src = url;\r\n      },\r\n      changeHorizontalScrollBarAccess(event : UniSwitchChangeEvent) {\r\n        this.horizontalScrollBarAccess = event.detail.value;\r\n      },\r\n      changeVerticalScrollBarAccess(event : UniSwitchChangeEvent) {\r\n        this.verticalScrollBarAccess = event.detail.value;\r\n      },\r\n      changeBounces(event : UniSwitchChangeEvent) {\r\n        this.bounces = event.detail.value;\r\n      },\r\n      // 自动化测试\r\n      touchstart(event : UniTouchEvent) {\r\n        if (this.autoTest) {\r\n          this.isTouchEnable = event.touches[0].clientX > 0 && event.touches[0].clientY > 0;\r\n        }\r\n      },\r\n      tap(event : UniPointerEvent) {\r\n        if (this.autoTest) {\r\n          this.isTouchEnable = event.clientX > 0 && event.clientY > 0;\r\n        }\r\n      },\r\n      //自动化测试专用\r\n      checkNativeWebView() : boolean {\r\n\r\n\r\n\r\n\r\n\r\n\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n  .margin-left-5 {\r\n    margin-left: 5px;\r\n  }\r\n\r\n  .align-items-center {\r\n    align-items: center;\r\n  }\r\n\r\n  .safe-area-inset-bottom {\r\n    height: var(--uni-safe-area-inset-bottom);\r\n  }\r\n</style>\r\n","import MiniProgramPage from 'W:/Workplace/2.小程序/lihai-app/pages/component/web-view/web-view.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","uni"],"mappings":"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"}
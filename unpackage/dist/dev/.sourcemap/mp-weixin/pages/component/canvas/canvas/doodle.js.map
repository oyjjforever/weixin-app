{"version":3,"file":"doodle.js","sources":["pages/component/canvas/canvas/doodle.uvue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29tcG9uZW50L2NhbnZhcy9jYW52YXMvZG9vZGxlLnV2dWU"],"sourcesContent":["<template>\r\n  <view>\r\n    <canvas class=\"drawing\" id=\"tablet\" @touchstart=\"touchStart\" @touchmove=\"touchMove\" @touchend=\"touchEnd\"></canvas>\r\n    <button @click=\"doClear()\">清空</button>\r\n  </view>\r\n</template>\r\n\r\n<script lang=\"uts\">\r\n  type Point = {\r\n    x : number\r\n    y : number\r\n  };\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        lastPointX: 0,\r\n        lastPointY: 0,\r\n        offsetX: 0,\r\n        offsetY: 0,\r\n        renderingContext: null as CanvasRenderingContext2D | null,\r\n      }\r\n    },\r\n    onReady() {\r\n      uni.createCanvasContextAsync({\r\n        id: 'tablet',\r\n        // component: this,\r\n        success: (context : CanvasContext) => {\r\n          uni.__f__('log','at pages/component/canvas/canvas/doodle.uvue:29','success');\r\n          this.renderingContext = context.getContext('2d')!;\r\n          const canvas = this.renderingContext!.canvas;\r\n\r\n          const dpr = uni.getWindowInfo().pixelRatio;\r\n          canvas.width = canvas.offsetWidth * dpr\r\n          canvas.height = canvas.offsetHeight * dpr\r\n          this.renderingContext!.scale(dpr, dpr)\r\n\r\n\r\n\r\n\r\n\r\n\r\n        }\r\n      })\r\n    },\r\n    methods: {\r\n      touchStart(event : TouchEvent) {\r\n        const position = this.getPosition(event)\r\n        this.lastPointX = position.x\r\n        this.lastPointY = position.y\r\n      },\r\n      touchMove(event : TouchEvent) {\r\n        const position = this.getPosition(event)\r\n        const x = position.x\r\n        const y = position.y\r\n\r\n        const ctx = this.renderingContext!\r\n        ctx.lineWidth = 5\r\n        ctx.lineCap = \"round\"\r\n        ctx.lineJoin = \"round\"\r\n        ctx.beginPath()\r\n        ctx.moveTo(this.lastPointX, this.lastPointY)\r\n        ctx.lineTo(x, y)\r\n        ctx.stroke()\r\n\r\n        this.lastPointX = x\r\n        this.lastPointY = y\r\n      },\r\n      touchEnd(_ : TouchEvent) {\r\n      },\r\n      doClear() {\r\n        if (this.renderingContext != null) {\r\n          this.renderingContext!.clearRect(0, 0, this.renderingContext!.canvas.width, this.renderingContext!.canvas.height)\r\n        }\r\n      },\r\n      getPosition(event : TouchEvent) : Point {\r\n        const touch = event.touches[0]\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        return {\r\n          x: touch.x,\r\n          y: touch.y\r\n        } as Point\r\n\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n  .drawing {\r\n    width: 100%;\r\n    height: 500px;\r\n    background-color: lightgray;\r\n    margin-bottom: 15px;\r\n  }\r\n</style>\r\n","import MiniProgramPage from 'W:/Workplace/2.小程序/lihai-app/pages/component/canvas/canvas/doodle.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","uni"],"mappings":";;MAQO;;;;;;;;;;;;;;;;;;;;;AAKL,MAAA,YAAeA,8BAAA;AAAA,EACb,OAAI;AACF,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,YAAY;AAAA,MACZ,SAAS;AAAA,MACT,SAAS;AAAA,MACT,kBAAkB;AAAA;EAErB;AAAA,EACD,UAAO;AACLC,kBAAAA,MAAI,yBAAyB;AAAA,MAC3B,IAAI;AAAA;AAAA,MAEJ,SAAS,CAAC,YAAuB;AAC/BA,sBAAAA,MAAI,MAAM,OAAM,mDAAkD,SAAS;AAC3E,aAAK,mBAAmB,QAAQ,WAAW,IAAI;AAC/C,cAAM,SAAS,KAAK,iBAAkB;AAEtC,cAAM,MAAMA,cAAAA,MAAI,cAAa,EAAG;AAChC,eAAO,QAAQ,OAAO,cAAc;AACpC,eAAO,SAAS,OAAO,eAAe;AACtC,aAAK,iBAAkB,MAAM,KAAK,GAAG;AAAA,MAOvC;AAAA,IACD,CAAA;AAAA,EACF;AAAA,EACD,SAAS;AAAA,IACP,WAAW,OAAkB;AAC3B,YAAM,WAAW,KAAK,YAAY,KAAK;AACvC,WAAK,aAAa,SAAS;AAC3B,WAAK,aAAa,SAAS;AAAA,IAC5B;AAAA,IACD,UAAU,OAAkB;AAC1B,YAAM,WAAW,KAAK,YAAY,KAAK;AACvC,YAAM,IAAI,SAAS;AACnB,YAAM,IAAI,SAAS;AAEnB,YAAM,MAAM,KAAK;AACjB,UAAI,YAAY;AAChB,UAAI,UAAU;AACd,UAAI,WAAW;AACf,UAAI,UAAS;AACb,UAAI,OAAO,KAAK,YAAY,KAAK,UAAU;AAC3C,UAAI,OAAO,GAAG,CAAC;AACf,UAAI,OAAM;AAEV,WAAK,aAAa;AAClB,WAAK,aAAa;AAAA,IACnB;AAAA,IACD,SAAS,GAAc;AAAA,IACtB;AAAA,IACD,UAAO;AACL,UAAI,KAAK,oBAAoB,MAAM;AACjC,aAAK,iBAAkB,UAAU,GAAG,GAAG,KAAK,iBAAkB,OAAO,OAAO,KAAK,iBAAkB,OAAO,MAAM;AAAA,MAClH;AAAA,IACD;AAAA,IACD,YAAY,OAAkB;AAC5B,YAAM,QAAQ,MAAM,QAAQ,CAAC;AAS7B,aAAO,IAAA,MAAA;AAAA,QACL,GAAG,MAAM;AAAA,QACT,GAAG,MAAM;AAAA,OACF;AAAA,IAEX;AAAA,EACF;CACF;;;;;;;;;;;;AC3FF,GAAG,WAAW,eAAe;"}
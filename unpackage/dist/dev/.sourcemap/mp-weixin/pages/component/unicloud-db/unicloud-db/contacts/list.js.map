{"version":3,"file":"list.js","sources":["pages/component/unicloud-db/unicloud-db/contacts/list.uvue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29tcG9uZW50L3VuaWNsb3VkLWRiL3VuaWNsb3VkLWRiL2NvbnRhY3RzL2xpc3QudXZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"page\">\r\n    <unicloud-db ref=\"udb\" class=\"udb\" v-slot:default=\"{data, pagination, loading, hasMore, error}\"\r\n      :collection=\"collection\" :page-size=\"15\" :getcount=\"true\" loadtime=\"manual\">\r\n      <view v-if=\"error!=null\" class=\"error\">{{error.errMsg}}</view>\r\n      <scroll-view ref=\"listView\" class=\"list-view\" @scrolltolower=\"loadMore()\">\r\n        <view class=\"list-item\" v-for=\"(item, _) in data\" @click=\"gotoDetailPage(item['_id'] as string)\">\r\n          <view class=\"list-item-fill\">\r\n            <text class=\"name\">{{item['username']}}</text>\r\n            <text class=\"mobile\">{{item['mobile']}}</text>\r\n          </view>\r\n        </view>\r\n      </scroll-view>\r\n      <uni-loading v-if=\"loading\" class=\"loading\" color=\"#999\" text=\"正在加载...\"></uni-loading>\r\n      <view v-if=\"data.length>0\" class=\"pagination\">\r\n        <text class=\"pagination-item\">{{data.length}} / {{pagination.count}}</text>\r\n      </view>\r\n    </unicloud-db>\r\n    <view class=\"btn-plus\" @click=\"gotoAddPage\">\r\n      <text class=\"btn-plus-text\">+</text>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script lang=\"uts\">\r\n  import { COLLECTION_NAME, UNICLOUD_DB_CONTACTS_ADD, UNICLOUD_DB_CONTACTS_UPDATE, UNICLOUD_DB_CONTACTS_DELETE } from './types.uts'\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        collection: COLLECTION_NAME,\r\n        uniCloudElement: null as UniCloudDBElement | null\r\n      }\r\n    },\r\n    onReady() {\r\n      // TODO 后续通过 EventChannel 实现\r\n      uni.$on(UNICLOUD_DB_CONTACTS_DELETE, this.onDataChange);\r\n      this.uniCloudElement = this.$refs['udb'] as UniCloudDBElement\r\n      this.uniCloudElement!.loadData()\r\n    },\r\n    onUnload() {\r\n      // TODO 后续通过 EventChannel 实现\r\n      uni.$off(UNICLOUD_DB_CONTACTS_ADD, this.onDataChange);\r\n      uni.$off(UNICLOUD_DB_CONTACTS_UPDATE, this.onDataChange);\r\n      uni.$off(UNICLOUD_DB_CONTACTS_DELETE, this.onDataChange);\r\n    },\r\n    onShow() {\r\n      // TODO 后续通过 EventChannel 实现\r\n      uni.$off(UNICLOUD_DB_CONTACTS_ADD, this.onDataChange);\r\n      uni.$off(UNICLOUD_DB_CONTACTS_UPDATE, this.onDataChange);\r\n    },\r\n    onPullDownRefresh() {\r\n      this.uniCloudElement!.loadData({\r\n        clear: true,\r\n        success: (_ : UniCloudDBGetResult) => {\r\n          uni.stopPullDownRefresh()\r\n        }\r\n      })\r\n    },\r\n    methods: {\r\n      loadMore() {\r\n        this.uniCloudElement!.loadMore()\r\n      },\r\n      gotoAddPage() {\r\n        // TODO 后续通过 EventChannel 实现\r\n        uni.$on(UNICLOUD_DB_CONTACTS_ADD, this.onDataChange);\r\n        uni.navigateTo({\r\n          url: './add'\r\n        })\r\n      },\r\n      gotoDetailPage(id : string) {\r\n        // TODO 后续通过 EventChannel 实现\r\n        uni.$on(UNICLOUD_DB_CONTACTS_UPDATE, this.onDataChange);\r\n        uni.navigateTo({\r\n          url: './detail?id=' + id\r\n        })\r\n      },\r\n      onDataChange(_ : string) {\r\n        this.uniCloudElement!.loadData({\r\n          clear: true\r\n        })\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n  .page {\r\n\r\n\r\n\r\n    flex-direction: column;\r\n  }\r\n\r\n  .loading {\r\n    margin: 20px;\r\n    align-self: center;\r\n  }\r\n\r\n  .udb {\r\n    flex: 1;\r\n    /* TODO */\r\n\r\n\r\n\r\n    flex-direction: column;\r\n  }\r\n\r\n  .list-view {\r\n    flex: 1;\r\n    flex-direction: column;\r\n  }\r\n\r\n  .list-item {\r\n    flex-direction: row;\r\n    padding: 10px;\r\n    background-color: #fff;\r\n    margin-bottom: 1px;\r\n  }\r\n\r\n  .mobile {\r\n    margin-top: 5px;\r\n  }\r\n\r\n  .btn-plus {\r\n    position: absolute;\r\n    width: 64px;\r\n    height: 64px;\r\n    right: 20px;\r\n    bottom: 20px;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background-color: #1e90ff;\r\n    border-radius: 64px;\r\n  }\r\n\r\n  .btn-plus-text {\r\n    font-size: 30px;\r\n    color: #fff;\r\n  }\r\n\r\n  .pagination {\r\n    align-items: center;\r\n    background-color: #f8f8f8;\r\n    padding: 15px;\r\n  }\r\n</style>\r\n","import MiniProgramPage from 'W:/Workplace/2.小程序/lihai-app/pages/component/unicloud-db/unicloud-db/contacts/list.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","COLLECTION_NAME","uni","UNICLOUD_DB_CONTACTS_DELETE","UNICLOUD_DB_CONTACTS_ADD","UNICLOUD_DB_CONTACTS_UPDATE"],"mappings":";;;AA2BE,MAAA,YAAeA,8BAAA;AAAA,EACb,OAAI;AACF,WAAO;AAAA,MACL,YAAYC,qDAAe;AAAA,MAC3B,iBAAiB;AAAA;EAEpB;AAAA,EACD,UAAO;AAELC,kBAAAA,MAAI,IAAIC,qDAAAA,6BAA6B,KAAK,YAAY;AACtD,SAAK,kBAAkB,KAAK,MAAM,KAAK;AACvC,SAAK,gBAAiB;EACvB;AAAA,EACD,WAAQ;AAEND,kBAAAA,MAAI,KAAKE,qDAAAA,0BAA0B,KAAK,YAAY;AACpDF,kBAAAA,MAAI,KAAKG,qDAAAA,6BAA6B,KAAK,YAAY;AACvDH,kBAAAA,MAAI,KAAKC,qDAAAA,6BAA6B,KAAK,YAAY;AAAA,EACxD;AAAA,EACD,SAAM;AAEJD,kBAAAA,MAAI,KAAKE,qDAAAA,0BAA0B,KAAK,YAAY;AACpDF,kBAAAA,MAAI,KAAKG,qDAAAA,6BAA6B,KAAK,YAAY;AAAA,EACxD;AAAA,EACD,oBAAiB;AACf,SAAK,gBAAiB,SAAS,IAAA,cAAA;AAAA,MAC7B,OAAO;AAAA,MACP,SAAS,CAAC,MAAuB;AAC/BH,sBAAG,MAAC,oBAAmB;AAAA,MACzB;AAAA,IACD,CAAA,CAAA;AAAA,EACF;AAAA,EACD,SAAS;AAAA,IACP,WAAQ;AACN,WAAK,gBAAiB;IACvB;AAAA,IACD,cAAW;AAETA,oBAAAA,MAAI,IAAIE,qDAAAA,0BAA0B,KAAK,YAAY;AACnDF,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACN,CAAA;AAAA,IACF;AAAA,IACD,eAAe,IAAW;AAExBA,oBAAAA,MAAI,IAAIG,qDAAAA,6BAA6B,KAAK,YAAY;AACtDH,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,iBAAiB;AAAA,MACvB,CAAA;AAAA,IACF;AAAA,IACD,aAAa,GAAU;AACrB,WAAK,gBAAiB,SAAS,IAAA,cAAA;AAAA,QAC7B,OAAO;AAAA,MACR,CAAA,CAAA;AAAA,IACH;AAAA,EACF;CACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClFF,GAAG,WAAW,eAAe;"}
{"version":3,"file":"touch-events.js","sources":["pages/component/global-events/touch-events.uvue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29tcG9uZW50L2dsb2JhbC1ldmVudHMvdG91Y2gtZXZlbnRzLnV2dWU"],"sourcesContent":["<template>\n  <scroll-view style=\"flex: 1\">\n    <page-head title=\"拖拽图标测试相关事件(在小程序上本示例会卡顿,小程序上应使用movable-view)\"></page-head>\n    <view class=\"uni-padding-wrap uni-common-mt\" style=\"bottom: 20px;\">\n      <navigator url=\"/pages/component/global-events/touch-events-case\" hover-class=\"none\">\n        <button type=\"default\">\n          stopPropagation / preventDefault\n        </button>\n      </navigator>\n    </view>\n    <view class=\"container\">\n      <view class=\"view-box\" @touchstart=\"onViewTouchStart\">\n        <image class=\"icon\" id=\"icon\" src=\"../image/logo.png\" @touchstart=\"onTouchStart\" @touchcancel=\"onTouchCancel\"\n          @touchmove=\"onTouchMove\" @touchend=\"onTouchEnd\"></image>\n      </view>\n\n    </view>\n    <view v-if=\"touchEvent !== null\">\n      <text class=\"title1\">touches: </text>\n      <template v-for=\"(touch, index) in touchEvent!.touches\" :key=\"index\">\n        <text class=\"title2\">touch[{{ index }}]:</text>\n        <text>identifier: {{touch.identifier}}</text>\n        <text>pageX: {{ touch.pageX }}, pageY: {{ touch.pageY }}</text>\n        <text>clientX: {{ touch.clientX }}, clientY: {{ touch.clientY }}</text>\n        <text>screenX: {{ touch.screenX }}, screenY: {{ touch.screenY }}</text>\n      </template>\n    </view>\n  </scroll-view>\n</template>\n\n<script lang=\"uts\">\n  export default {\n    data() {\n      return {\n        move: false,\n        posX: 0,\n        posY: 0,\n        lastX: 0,\n        lastY: 0,\n        touchEvent: null as TouchEvent | null,\n        icon: null as UniElement | null,\n        touchTargets: \"\",\n        touchTargetsCount: 0,\n        iconRect : null as DOMRect | null\n      }\n    },\n    onReady() {\n      this.icon = uni.getElementById(\"icon\")\n\n\n\n\n\n    },\n    methods: {\n      onViewTouchStart(e : TouchEvent) {\n        this.touchTargets += e.target!.tagName + e.currentTarget!.tagName\n        this.touchTargetsCount++\n      },\n      onTouchStart(e : TouchEvent) {\n        this.touchTargetsCount++\n        this.touchTargets += e.target!.tagName + e.currentTarget!.tagName\n\n        this.touchEvent = e\n        if (!this.move) {\n          this.move = true\n          this.posX = e.touches[0].screenX\n          this.posY = e.touches[0].screenY\n        }\n      },\n      onTouchMove(e : TouchEvent) {\n        e.preventDefault()\n        this.touchEvent = e\n        let p = e.touches[0]\n        if (p.screenX == this.lastX && p.screenY == this.lastY) {\n          return\n        }\n        let x = p.screenX - this.posX\n        let y = p.screenY - this.posY\n        this.lastX = p.screenX\n        this.lastY = p.screenY\n        this.icon?.style?.setProperty('transform', 'translate(' + x + 'px,' + y + 'px)')\n      },\n      onTouchEnd(e : TouchEvent) {\n        if (e.touches.length == 0) {\n          this.resetIcon()\n          this.touchEvent = null\n        }\n      },\n      onTouchCancel(_ : TouchEvent) {\n        this.resetIcon()\n        this.touchEvent = null\n      },\n      resetIcon() {\n        this.move = false;\n        this.posX = 0;\n        this.posY = 0;\n        this.icon?.style?.setProperty('transform', 'translate(0px,0px)')\n      }\n    }\n  }\n</script>\n\n<style>\n  .container {\n    width: 100%;\n    flex-direction: column;\n    align-items: center;\n  }\n\n  .view-box {\n    width: 300px;\n    height: 300px;\n    align-items: center;\n    justify-content: center;\n    border-style: solid;\n  }\n\n  .icon {\n    width: 100px;\n    height: 100px;\n  }\n\n  .title1 {\n    margin-top: 10px;\n    font-size: 18px;\n  }\n\n  .title2 {\n    margin-top: 5px;\n    font-size: 16px;\n  }\n</style>\n","import MiniProgramPage from 'W:/Workplace/2.小程序/lihai-app/pages/component/global-events/touch-events.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","uni"],"mappings":";;;AA+BE,MAAA,YAAeA,8BAAA;AAAA,EACb,OAAI;AACF,WAAO;AAAA,MACL,MAAM;AAAA,MACN,MAAM;AAAA,MACN,MAAM;AAAA,MACN,OAAO;AAAA,MACP,OAAO;AAAA,MACP,YAAY;AAAA,MACZ,MAAM;AAAA,MACN,cAAc;AAAA,MACd,mBAAmB;AAAA,MACnB,UAAW;AAAA;EAEd;AAAA,EACD,UAAO;AACL,SAAK,OAAOC,cAAAA,MAAI,eAAe,MAAM;AAAA,EAMtC;AAAA,EACD,SAAS;AAAA,IACP,iBAAiB,GAAc;AAC7B,WAAK,gBAAgB,EAAE,OAAQ,UAAU,EAAE,cAAe;AAC1D,WAAK;AAAA,IACN;AAAA,IACD,aAAa,GAAc;AACzB,WAAK;AACL,WAAK,gBAAgB,EAAE,OAAQ,UAAU,EAAE,cAAe;AAE1D,WAAK,aAAa;AAClB,UAAI,CAAC,KAAK,MAAM;AACd,aAAK,OAAO;AACZ,aAAK,OAAO,EAAE,QAAQ,CAAC,EAAE;AACzB,aAAK,OAAO,EAAE,QAAQ,CAAC,EAAE;AAAA,MAC3B;AAAA,IACD;AAAA,IACD,YAAY,GAAc;;AACxB,QAAE,eAAc;AAChB,WAAK,aAAa;AAClB,UAAI,IAAI,EAAE,QAAQ,CAAC;AACnB,UAAI,EAAE,WAAW,KAAK,SAAS,EAAE,WAAW,KAAK,OAAO;AACtD,eAAK;AAAA,MACP;AACA,UAAI,IAAI,EAAE,UAAU,KAAK;AACzB,UAAI,IAAI,EAAE,UAAU,KAAK;AACzB,WAAK,QAAQ,EAAE;AACf,WAAK,QAAQ,EAAE;AACf,OAAA,MAAA,KAAA,KAAK,4CAAM,WAAK,QAAA,OAAA,SAAA,OAAA,GAAE,YAAY,aAAa,eAAe,IAAI,QAAQ,IAAI,KAAK;AAAA,IAChF;AAAA,IACD,WAAW,GAAc;AACvB,UAAI,EAAE,QAAQ,UAAU,GAAG;AACzB,aAAK,UAAS;AACd,aAAK,aAAa;AAAA,MACpB;AAAA,IACD;AAAA,IACD,cAAc,GAAc;AAC1B,WAAK,UAAS;AACd,WAAK,aAAa;AAAA,IACnB;AAAA,IACD,YAAS;;AACP,WAAK,OAAO;AACZ,WAAK,OAAO;AACZ,WAAK,OAAO;AACZ,OAAA,MAAA,KAAA,KAAK,UAAM,QAAA,OAAA,SAAA,OAAA,GAAA,WAAO,QAAA,OAAA,SAAA,OAAA,GAAA,YAAY,aAAa,oBAAoB;AAAA,IACjE;AAAA,EACF;CACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnGF,GAAG,WAAW,eAAe;"}
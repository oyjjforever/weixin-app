{"version":3,"file":"detail.js","sources":["pages/notice/detail.vue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbm90aWNlL2RldGFpbC52dWU"],"sourcesContent":["<template>\r\n  <view class=\"container\">\r\n    <!-- 顶部导航区域 -->\r\n    <view class=\"nav-bar\">\r\n      <view class=\"nav-left\" @click=\"goBack\">\r\n        <uni-icons type=\"back\" size=\"24\" color=\"#ffffff\"></uni-icons>\r\n      </view>\r\n      <view class=\"nav-title\">\r\n        <text>通知详情</text>\r\n      </view>\r\n      <view class=\"nav-right\">\r\n        <uni-icons type=\"redo\" size=\"24\" color=\"#ffffff\" @click=\"handleShare\"></uni-icons>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 通知内容区域 -->\r\n    <view class=\"content-container\" v-if=\"noticeInfo\">\r\n      <!-- 通知类型标签 -->\r\n      <view class=\"type-badge\" :class=\"'type-' + noticeInfo.type\">\r\n        <text>{{ getTypeText(noticeInfo.type) }}</text>\r\n      </view>\r\n\r\n      <!-- 通知标题 -->\r\n      <view class=\"title-section\">\r\n        <text class=\"notice-title\">{{ noticeInfo.title }}</text>\r\n        <view class=\"notice-meta\">\r\n          <text class=\"publish-time\">发布时间：{{ formatDate(noticeInfo.create_date) }}</text>\r\n          <text class=\"valid-time\" v-if=\"noticeInfo.endTime\">\r\n            有效期至：{{ formatDate(noticeInfo.endTime) }}\r\n          </text>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 通知图片 -->\r\n      <view class=\"image-section\" v-if=\"noticeInfo.image\">\r\n        <image :src=\"noticeInfo.image\" mode=\"widthFix\" class=\"notice-image\" @click=\"previewImage\"></image>\r\n      </view>\r\n\r\n      <!-- 通知内容 -->\r\n      <view class=\"content-section\">\r\n        <text class=\"content-text\">{{ noticeInfo.content }}</text>\r\n      </view>\r\n\r\n      <!-- 操作按钮 -->\r\n      <view class=\"action-section\" v-if=\"noticeInfo.linkType && noticeInfo.linkType !== 'none'\">\r\n        <view class=\"action-btn\" @click=\"handleLinkClick\">\r\n          <text>{{ getActionText(noticeInfo.linkType) }}</text>\r\n          <uni-icons type=\"right\" size=\"18\" color=\"#ffffff\"></uni-icons>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 底部信息 -->\r\n      <view class=\"footer-section\">\r\n        <view class=\"footer-item\">\r\n          <uni-icons type=\"calendar\" size=\"16\" color=\"#999\"></uni-icons>\r\n          <text class=\"footer-text\">创建于：{{ formatDateTime(noticeInfo.create_date) }}</text>\r\n        </view>\r\n        <view class=\"footer-item\" v-if=\"noticeInfo.update_date && noticeInfo.update_date !== noticeInfo.create_date\">\r\n          <uni-icons type=\"refresh\" size=\"16\" color=\"#999\"></uni-icons>\r\n          <text class=\"footer-text\">更新于：{{ formatDateTime(noticeInfo.update_date) }}</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 加载状态 -->\r\n    <view class=\"loading-state\" v-else-if=\"loading\">\r\n      <uni-icons type=\"spinner-cycle\" size=\"48\" color=\"#999\"></uni-icons>\r\n      <text class=\"loading-text\">加载中...</text>\r\n    </view>\r\n\r\n    <!-- 空状态 -->\r\n    <view class=\"empty-state\" v-else>\r\n      <uni-icons type=\"info\" size=\"64\" color=\"#d9d9d9\"></uni-icons>\r\n      <text class=\"empty-text\">通知不存在或已被删除</text>\r\n      <view class=\"back-btn\" @click=\"goBack\">\r\n        <text>返回</text>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { ref, onMounted } from 'vue';\r\n\r\ninterface NoticeInfo {\r\n  _id?: string;\r\n  title: string;\r\n  content: string;\r\n  type: 'promotion' | 'announcement' | 'maintenance';\r\n  image?: string;\r\n  linkUrl?: string;\r\n  linkType?: 'none' | 'page' | 'url' | 'product';\r\n  priority?: number;\r\n  status?: string;\r\n  startTime?: number;\r\n  endTime?: number;\r\n  sort?: number;\r\n  create_date?: number;\r\n  update_date?: number;\r\n}\r\n\r\nconst noticeInfo = ref<NoticeInfo | null>(null);\r\nconst loading = ref(false);\r\n\r\n// 获取通知详情数据\r\nconst getNoticeDetail = async (noticeId: string) => {\r\n  loading.value = true;\r\n  try {\r\n    const result = await uniCloud.callFunction({\r\n      name: 'getNoticeDetail',\r\n      data: { id: noticeId }\r\n    });\r\n    \r\n    if (result.result.code === 0) {\r\n      noticeInfo.value = result.result.data;\r\n    } else {\r\n      uni.showToast({\r\n        title: result.result.message || '获取通知详情失败',\r\n        icon: 'none'\r\n      });\r\n    }\r\n  } catch (error) {\r\n    uni.__f__('error','at pages/notice/detail.vue:123','获取通知详情失败:', error);\r\n    uni.showToast({\r\n      title: '网络错误，请重试',\r\n      icon: 'none'\r\n    });\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\n// 获取通知类型文本\r\nconst getTypeText = (type: string) => {\r\n  const typeMap: Record<string, string> = {\r\n    promotion: '促销活动',\r\n    announcement: '公告',\r\n    maintenance: '维护通知'\r\n  };\r\n  return typeMap[type] || '通知';\r\n};\r\n\r\n// 获取操作按钮文本\r\nconst getActionText = (linkType: string) => {\r\n  const actionMap: Record<string, string> = {\r\n    page: '查看详情',\r\n    url: '访问链接',\r\n    product: '查看产品'\r\n  };\r\n  return actionMap[linkType] || '了解更多';\r\n};\r\n\r\n// 格式化日期\r\nconst formatDate = (timestamp?: number) => {\r\n  if (!timestamp) return '';\r\n  const date = new Date(timestamp);\r\n  const year = date.getFullYear();\r\n  const month = String(date.getMonth() + 1).padStart(2, '0');\r\n  const day = String(date.getDate()).padStart(2, '0');\r\n  return `${year}-${month}-${day}`;\r\n};\r\n\r\n// 格式化日期时间\r\nconst formatDateTime = (timestamp?: number) => {\r\n  if (!timestamp) return '';\r\n  const date = new Date(timestamp);\r\n  const year = date.getFullYear();\r\n  const month = String(date.getMonth() + 1).padStart(2, '0');\r\n  const day = String(date.getDate()).padStart(2, '0');\r\n  const hours = String(date.getHours()).padStart(2, '0');\r\n  const minutes = String(date.getMinutes()).padStart(2, '0');\r\n  return `${year}-${month}-${day} ${hours}:${minutes}`;\r\n};\r\n\r\n// 预览图片\r\nconst previewImage = () => {\r\n  if (noticeInfo.value && noticeInfo.value.image) {\r\n    uni.previewImage({\r\n      urls: [noticeInfo.value.image],\r\n      current: noticeInfo.value.image\r\n    });\r\n  }\r\n};\r\n\r\n// 处理链接点击\r\nconst handleLinkClick = () => {\r\n  if (!noticeInfo.value) return;\r\n  \r\n  const { linkType, linkUrl } = noticeInfo.value;\r\n  \r\n  if (!linkUrl) {\r\n    uni.showToast({\r\n      title: '链接地址无效',\r\n      icon: 'none'\r\n    });\r\n    return;\r\n  }\r\n\r\n  switch (linkType) {\r\n    case 'page':\r\n      uni.navigateTo({\r\n        url: linkUrl,\r\n        fail: () => {\r\n          uni.switchTab({\r\n            url: linkUrl,\r\n            fail: () => {\r\n              uni.showToast({\r\n                title: '页面跳转失败',\r\n                icon: 'none'\r\n              });\r\n            }\r\n          });\r\n        }\r\n      });\r\n      break;\r\n    case 'url':\r\n\r\n\r\n\r\n\r\n      uni.showModal({\r\n        title: '提示',\r\n        content: '是否在浏览器中打开链接？',\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            plus.runtime.openURL(linkUrl);\r\n          }\r\n        }\r\n      });\r\n\r\n      break;\r\n    case 'product':\r\n      uni.navigateTo({\r\n        url: `/pages/index/detail?id=${linkUrl}`,\r\n        fail: () => {\r\n          uni.showToast({\r\n            title: '产品详情跳转失败',\r\n            icon: 'none'\r\n          });\r\n        }\r\n      });\r\n      break;\r\n    default:\r\n      break;\r\n  }\r\n};\r\n\r\n// 返回上一页\r\nconst goBack = () => {\r\n  uni.navigateBack();\r\n};\r\n\r\n// 分享\r\nconst handleShare = () => {\r\n  uni.showShareMenu({\r\n    withShareTicket: true\r\n  });\r\n};\r\n\r\n// 页面加载时获取数据\r\nonMounted(() => {\r\n  const pages = getCurrentPages();\r\n  const currentPage = pages[pages.length - 1];\r\n  const options = currentPage.options;\r\n  \r\n  if (options && options.id) {\r\n    getNoticeDetail(options.id);\r\n  } else {\r\n    uni.showToast({\r\n      title: '缺少通知ID',\r\n      icon: 'none'\r\n    });\r\n  }\r\n});\r\n</script>\r\n\r\n<style scoped>\r\npage {\r\n  height: 100%;\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  min-height: 100%;\r\n}\r\n\r\n.nav-bar {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  height: 88rpx;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 0 30rpx;\r\n  background-color: rgba(0, 0, 0, 0.4);\r\n  z-index: 100;\r\n}\r\n\r\n.nav-left {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 10rpx;\r\n  border-radius: 50%;\r\n  background-color: rgba(255, 255, 255, 0.2);\r\n  cursor: pointer;\r\n}\r\n\r\n.nav-left:active {\r\n  background-color: rgba(255, 255, 255, 0.3);\r\n}\r\n\r\n.nav-title {\r\n  flex: 1;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.nav-title text {\r\n  font-size: 18px;\r\n  font-weight: bold;\r\n  color: #ffffff;\r\n}\r\n\r\n.nav-right {\r\n  display: flex;\r\n  gap: 40rpx;\r\n}\r\n\r\n.content-container {\r\n  padding: 120rpx 30rpx 40rpx;\r\n  background-color: #ffffff;\r\n  min-height: 100%;\r\n}\r\n\r\n.type-badge {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 8rpx 24rpx;\r\n  border-radius: 30rpx;\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.type-promotion {\r\n  background: linear-gradient(90deg, #ff6b6b 0%, #ff8e53 100%);\r\n}\r\n\r\n.type-announcement {\r\n  background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);\r\n}\r\n\r\n.type-maintenance {\r\n  background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);\r\n}\r\n\r\n.type-badge text {\r\n  font-size: 14px;\r\n  color: #ffffff;\r\n  font-weight: 500;\r\n}\r\n\r\n.title-section {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.notice-title {\r\n  display: block;\r\n  font-size: 22px;\r\n  font-weight: bold;\r\n  color: #333333;\r\n  line-height: 1.4;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.notice-meta {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10rpx;\r\n}\r\n\r\n.publish-time,\r\n.valid-time {\r\n  font-size: 14px;\r\n  color: #999999;\r\n}\r\n\r\n.image-section {\r\n  margin-bottom: 30rpx;\r\n  border-radius: 16rpx;\r\n  overflow: hidden;\r\n}\r\n\r\n.notice-image {\r\n  width: 100%;\r\n  display: block;\r\n  border-radius: 16rpx;\r\n}\r\n\r\n.content-section {\r\n  padding: 30rpx;\r\n  background-color: #f8f9fa;\r\n  border-radius: 16rpx;\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.content-text {\r\n  font-size: 16px;\r\n  color: #333333;\r\n  line-height: 1.8;\r\n  white-space: pre-wrap;\r\n}\r\n\r\n.action-section {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.action-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 16rpx;\r\n  padding: 24rpx 48rpx;\r\n  background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);\r\n  border-radius: 50rpx;\r\n  box-shadow: 0 4rpx 12rpx rgba(79, 172, 254, 0.3);\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.action-btn:active {\r\n  transform: scale(0.98);\r\n  box-shadow: 0 2rpx 8rpx rgba(79, 172, 254, 0.3);\r\n}\r\n\r\n.action-btn text {\r\n  font-size: 16px;\r\n  color: #ffffff;\r\n  font-weight: 500;\r\n}\r\n\r\n.footer-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16rpx;\r\n  padding-top: 30rpx;\r\n  border-top: 1px solid #eeeeee;\r\n}\r\n\r\n.footer-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12rpx;\r\n}\r\n\r\n.footer-text {\r\n  font-size: 14px;\r\n  color: #999999;\r\n}\r\n\r\n.loading-state {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 120rpx 40rpx;\r\n}\r\n\r\n.loading-text {\r\n  margin-top: 20rpx;\r\n  font-size: 14px;\r\n  color: #999999;\r\n}\r\n\r\n.empty-state {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 120rpx 40rpx;\r\n}\r\n\r\n.empty-text {\r\n  margin-top: 20rpx;\r\n  font-size: 16px;\r\n  color: #666666;\r\n  margin-bottom: 40rpx;\r\n}\r\n\r\n.back-btn {\r\n  padding: 16rpx 48rpx;\r\n  background-color: #4facfe;\r\n  border-radius: 50rpx;\r\n}\r\n\r\n.back-btn text {\r\n  font-size: 16px;\r\n  color: #ffffff;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/APP_WORKPLACE/其他/lxjj-app/pages/notice/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uniCloud","uni","onMounted"],"mappings":";;;;;;;;;AAqGM,UAAA,aAAaA,kBAAuB,IAAI;AACxC,UAAA,UAAUA,kBAAI,KAAK;AAGnB,UAAA,kBAAkB,OAAO,aAAqB;AAClD,cAAQ,QAAQ;AACZ,UAAA;AACI,cAAA,SAAS,MAAMC,cAAA,GAAS,aAAa;AAAA,UACzC,MAAM;AAAA,UACN,MAAM,EAAE,IAAI,SAAS;AAAA,QAAA,CACtB;AAEG,YAAA,OAAO,OAAO,SAAS,GAAG;AACjB,qBAAA,QAAQ,OAAO,OAAO;AAAA,QAAA,OAC5B;AACLC,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO,OAAO,OAAO,WAAW;AAAA,YAChC,MAAM;AAAA,UAAA,CACP;AAAA,QACH;AAAA,eACO,OAAO;AACdA,sBAAA,MAAI,MAAM,SAAQ,kCAAiC,aAAa,KAAK;AACrEA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QAAA,CACP;AAAA,MAAA,UACD;AACA,gBAAQ,QAAQ;AAAA,MAClB;AAAA,IAAA;AAII,UAAA,cAAc,CAAC,SAAiB;AACpC,YAAM,UAAkC;AAAA,QACtC,WAAW;AAAA,QACX,cAAc;AAAA,QACd,aAAa;AAAA,MAAA;AAER,aAAA,QAAQ,IAAI,KAAK;AAAA,IAAA;AAIpB,UAAA,gBAAgB,CAAC,aAAqB;AAC1C,YAAM,YAAoC;AAAA,QACxC,MAAM;AAAA,QACN,KAAK;AAAA,QACL,SAAS;AAAA,MAAA;AAEJ,aAAA,UAAU,QAAQ,KAAK;AAAA,IAAA;AAI1B,UAAA,aAAa,CAAC,cAAuB;AACzC,UAAI,CAAC;AAAkB,eAAA;AACjB,YAAA,OAAO,IAAI,KAAK,SAAS;AACzB,YAAA,OAAO,KAAK;AACZ,YAAA,QAAQ,OAAO,KAAK,SAAA,IAAa,CAAC,EAAE,SAAS,GAAG,GAAG;AACnD,YAAA,MAAM,OAAO,KAAK,QAAS,CAAA,EAAE,SAAS,GAAG,GAAG;AAClD,aAAO,GAAG,IAAI,IAAI,KAAK,IAAI,GAAG;AAAA,IAAA;AAI1B,UAAA,iBAAiB,CAAC,cAAuB;AAC7C,UAAI,CAAC;AAAkB,eAAA;AACjB,YAAA,OAAO,IAAI,KAAK,SAAS;AACzB,YAAA,OAAO,KAAK;AACZ,YAAA,QAAQ,OAAO,KAAK,SAAA,IAAa,CAAC,EAAE,SAAS,GAAG,GAAG;AACnD,YAAA,MAAM,OAAO,KAAK,QAAS,CAAA,EAAE,SAAS,GAAG,GAAG;AAC5C,YAAA,QAAQ,OAAO,KAAK,SAAU,CAAA,EAAE,SAAS,GAAG,GAAG;AAC/C,YAAA,UAAU,OAAO,KAAK,WAAY,CAAA,EAAE,SAAS,GAAG,GAAG;AAClD,aAAA,GAAG,IAAI,IAAI,KAAK,IAAI,GAAG,IAAI,KAAK,IAAI,OAAO;AAAA,IAAA;AAIpD,UAAM,eAAe,MAAM;AACzB,UAAI,WAAW,SAAS,WAAW,MAAM,OAAO;AAC9CA,sBAAAA,MAAI,aAAa;AAAA,UACf,MAAM,CAAC,WAAW,MAAM,KAAK;AAAA,UAC7B,SAAS,WAAW,MAAM;AAAA,QAAA,CAC3B;AAAA,MACH;AAAA,IAAA;AAIF,UAAM,kBAAkB,MAAM;AAC5B,UAAI,CAAC,WAAW;AAAO;AAEvB,YAAM,EAAE,UAAU,YAAY,WAAW;AAEzC,UAAI,CAAC,SAAS;AACZA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QAAA,CACP;AACD;AAAA,MACF;AAEA,cAAQ,UAAU;AAAA,QAChB,KAAK;AACHA,wBAAAA,MAAI,WAAW;AAAA,YACb,KAAK;AAAA,YACL,MAAM,MAAM;AACVA,4BAAAA,MAAI,UAAU;AAAA,gBACZ,KAAK;AAAA,gBACL,MAAM,MAAM;AACVA,gCAAAA,MAAI,UAAU;AAAA,oBACZ,OAAO;AAAA,oBACP,MAAM;AAAA,kBAAA,CACP;AAAA,gBACH;AAAA,cAAA,CACD;AAAA,YACH;AAAA,UAAA,CACD;AACD;AAAA,QACF,KAAK;AAKHA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,SAAS;AAAA,YACT,SAAS,CAAC,QAAQ;AAChB,kBAAI,IAAI,SAAS;AACV,qBAAA,QAAQ,QAAQ,OAAO;AAAA,cAC9B;AAAA,YACF;AAAA,UAAA,CACD;AAED;AAAA,QACF,KAAK;AACHA,wBAAAA,MAAI,WAAW;AAAA,YACb,KAAK,0BAA0B,OAAO;AAAA,YACtC,MAAM,MAAM;AACVA,4BAAAA,MAAI,UAAU;AAAA,gBACZ,OAAO;AAAA,gBACP,MAAM;AAAA,cAAA,CACP;AAAA,YACH;AAAA,UAAA,CACD;AACD;AAAA,MAGJ;AAAA,IAAA;AAIF,UAAM,SAAS,MAAM;AACnBA,oBAAA,MAAI,aAAa;AAAA,IAAA;AAInB,UAAM,cAAc,MAAM;AACxBA,oBAAAA,MAAI,cAAc;AAAA,QAChB,iBAAiB;AAAA,MAAA,CAClB;AAAA,IAAA;AAIHC,kBAAAA,UAAU,MAAM;AACd,YAAM,QAAQ;AACd,YAAM,cAAc,MAAM,MAAM,SAAS,CAAC;AAC1C,YAAM,UAAU,YAAY;AAExB,UAAA,WAAW,QAAQ,IAAI;AACzB,wBAAgB,QAAQ,EAAE;AAAA,MAAA,OACrB;AACLD,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QAAA,CACP;AAAA,MACH;AAAA,IAAA,CACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChRD,GAAG,WAAW,eAAe;"}
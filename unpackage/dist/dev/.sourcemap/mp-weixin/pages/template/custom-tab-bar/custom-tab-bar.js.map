{"version":3,"file":"custom-tab-bar.js","sources":["pages/template/custom-tab-bar/custom-tab-bar.uvue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXNcdGVtcGxhdGVcY3VzdG9tLXRhYi1iYXJcY3VzdG9tLXRhYi1iYXIudXZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"tabs\">\n    <view ref=\"tabview\" class=\"tab-view\">\n      <!-- 注意tab的逻辑是：第一次使用v-if创建，创建之后不再使用v-if，而是设置visibility来隐藏和显示。不能设置tab的v-if为false，因为销毁再创建影响性能 -->\n      <tab1 ref=\"tab1\" class=\"tab-page\" v-if=\"tabList[0].init\" :style=\"{visibility:(selectedIndex==0?'visible':'hidden')}\"></tab1>\n      <tab2 ref=\"tab2\" class=\"tab-page\" v-if=\"tabList[1].init\" :style=\"{visibility:(selectedIndex==1?'visible':'hidden')}\"></tab2>\n    </view>\n    <view ref=\"tabbar\" class=\"tab-bar\">\n      <view class=\"tab-item\" @click=\"onTabClick(0)\">\n        <view ref=\"tab-item1\" class=\"tab-item-content\">\n          <text v-if=\"displayArrow\" class=\"tab-item-icon tab-item-arrow uni-icon\"\n            :class=\"selectedIndex==0 ? 'tab-item-text-active' : ''\">\n            {{'\\ue6bd'}}\n          </text>\n          <text v-if=\"!displayArrow\" class=\"tab-item-icon uni-icon\"\n            :class=\"selectedIndex==0 ? 'tab-item-text-active' : ''\">{{'\\ue644'}}</text>\n          <text v-if=\"!displayArrow\" class=\"tab-item-text\" :class=\"selectedIndex==0 ? 'tab-item-text-active' : ''\">\n            首页\n          </text>\n        </view>\n      </view>\n      <view>\n        <image class=\"concave-image\" mode=\"heightFix\" src=\"/static/template/custom-tab-bar/concave.png\"></image>\n      </view>\n      <view class=\"tab-item\" @click=\"onTabClick(1)\">\n        <view ref=\"tab-item2\" class=\"tab-item-content\">\n          <text class=\"tab-item-icon uni-icon\"\n            :class=\"selectedIndex==1 ? 'tab-item-text-active' : ''\">{{'\\ue699'}}</text>\n          <text class=\"tab-item-text\" :class=\"selectedIndex==1 ? 'tab-item-text-active' : ''\">\n            我的\n          </text>\n        </view>\n      </view>\n    </view>\n    <view class=\"btn-plus\" @click=\"onPlusClick\">\n      <text class=\"btn-plus-text\">+</text>\n    </view>\n  </view>\n</template>\n\n<script lang=\"uts\">\n  import tab1 from './custom-tab-bar-tab1.uvue';\n  import tab2 from './custom-tab-bar-tab2.uvue';\n\n  type TabItem = {\n    init : boolean,\n    preload : boolean,\n  }\n\n  export default {\n    components: {\n      tab1,\n      tab2\n    },\n    data() {\n      return {\n        tabList: [\n          {\n            init: true,\n            preload: false\n          } as TabItem,\n          {\n            init: false,\n            preload: false\n          } as TabItem,\n        ] as TabItem[],\n        selectedIndex: 0,\n        displayArrow: false,\n        lastTab1Top:0,\n        tabViewHeight: 0\n      }\n    },\n    onLoad() {\n      uni.$on('tabchange', this.onTabPageEvent) //监听tab1页面发出的tabchange事件，触发到本页面的onTabPageEvent方法。为了判断tab1的scroll-view滚动距离\n    },\n    onReady() {\n      // this.setSelectedIndex(0)\n      (this.$refs[\"tabview\"] as UniElement).getBoundingClientRectAsync()!.then((res: DOMRect) => {\r\n        this.tabViewHeight = res.height\r\n      });\n    },\n    onUnload() {\n      uni.$off('tabchange', this.onTabPageEvent)\n    },\n    methods: {\n      onTabClick(index : number) {\n        if (this.selectedIndex == index && index == 0 && this.displayArrow == true) { //首页当tab按钮变成向上时，点向上就滚动到顶\n          // uni.__f__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:88',\"11\");\n          this.displayArrow = false;\n          (this.$refs[\"tab1\"]! as ComponentPublicInstance).$callMethod('scrollTop', 0)\n        }\n        else if (index !=0){ //不在首页时，把箭头变成图标\n          // uni.__f__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:93',\"22\");\n          this.displayArrow = false\n        }\n        else if (index == 0 && this.selectedIndex !=0){ //从其他tab切回首页时，检查是否需要把图标变箭头\n          // uni.__f__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:97',\"33\",this.lastTab1Top, this.tabViewHeight);\n          this.displayArrow = this.lastTab1Top > this.tabViewHeight\n        }\n        this.setSelectedIndex(index);\n        // uni.__f__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:101','index: ',index);\n        // uni.__f__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:102','this.selectedIndex: ',this.selectedIndex);\n        // uni.__f__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:103','this.displayArrow: ',this.displayArrow);\n        // uni.__f__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:104','this.lastTab1Top: ',this.lastTab1Top);\n      },\n      onTabPageEvent(top : number) {\n        // uni.__f__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:107','top: ',top);\n        this.displayArrow = top > this.tabViewHeight //滚动1屏后，就把第一个tab的图标从首页变成向上箭头\n        this.lastTab1Top = top\n      },\n      setSelectedIndex(index : number) {\n        if (this.selectedIndex === index) {\n          return\n        }\n        if (!this.tabList[index].init) {\n          this.tabList[index].init = true\n        }\n        this.selectedIndex = index\n      },\n      onPlusClick() {\n        uni.showModal({\n          title: \"提示\",\n          content: \"你点击了 +\",\n          showCancel: false\n        })\n      }\n    }\n  }\n</script>\n\n<style>\n  @font-face {\n    font-family: \"UniIcon\";\n    src: url('@/static/fonts/uni-icon.ttf');\n  }\n\n  .uni-icon {\n    font-family: \"UniIcon\";\n    font-size: 16px;\n    font-style: normal;\n  }\n\n  .tabs {\n    flex: 1;\n    background-color: #fff;\n    overflow: visible;\n  }\n\n  .tab-view {\n    flex: 1;\n  }\n\n  .tab-page {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n  }\n\n  .tab-bar {\n    flex-direction: row;\n    height: 56px;\n    overflow: visible;\n  }\n\n  .tab-item {\n    flex: 1;\n    position: relative;\n    background-color: #1e90ff;\n    overflow: visible;\n  }\n\n  .tab-item-content {\n    margin: auto;\n    transition: transform 0.3s;\n  }\n\n  .tab-item-icon {\n    color: #ccc;\n    font-size: 12px;\n    text-align: center;\n    margin-bottom: 4px;\n  }\n\n  .tab-item-text {\n    color: #ccc;\n    font-size: 12px;\n    text-align: center;\n  }\n\n  .tab-item-text-active {\n    color: #fff;\n  }\n\n  .tab-item-arrow {\n    font-size: 30px !important;\n    font-weight: bold;\n  }\n\n  .concave-image {\n    height: 56px;\n  }\n\n  .btn-plus {\n    position: absolute;\n    width: 70px;\n    height: 70px;\n    bottom: 21px;\n    border-radius: 50px;\n    background-color: #FE5722;\n    box-shadow: 0 0 4px rgba(0, 0, 0, 0.5);\n    align-self: center;\n    align-items: center;\n    justify-content: center;\n    overflow: visible;\n  }\n\n  .btn-plus-text {\n    color: #fff;\n    font-size: 32px;\n  }\n</style>\n","import MiniProgramPage from 'W:/Workplace/2.小程序/lihai-app/pages/template/custom-tab-bar/custom-tab-bar.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","uni"],"mappings":";;;AAyCE,MAAO,OAAU,MAAA;AACjB,MAAO,OAAU,MAAA;MAEZ,gBAAM,IAAA,QAAA;AAAA;;;;;;;;;;;;;;;;;;;;AAKX,MAAA,YAAeA,8BAAA;AAAA,EACb,YAAY;AAAA,IACV;AAAA,IACA;AAAA,EACD;AAAA,EACD,OAAI;AACF,WAAO;AAAA,MACL,SAAS;AAAA,QACP,IAAA,QAAA;AAAA,UACE,MAAM;AAAA,UACN,SAAS;AAAA,QACC,CAAA;AAAA,QACZ,IAAA,QAAA;AAAA,UACE,MAAM;AAAA,UACN,SAAS;AAAA,QACC,CAAA;AAAA,MACA;AAAA,MACd,eAAe;AAAA,MACf,cAAc;AAAA,MACd,aAAY;AAAA,MACZ,eAAe;AAAA;EAElB;AAAA,EACD,SAAM;AACJC,kBAAAA,MAAI,IAAI,aAAa,KAAK,cAAc;AAAA,EACzC;AAAA,EACD,UAAO;AAEJ,SAAK,MAAM,SAAS,EAAiB,2BAA0B,EAAI,KAAK,CAAC,QAAY;AACpF,WAAK,gBAAgB,IAAI;AAAA,IAC3B,CAAC;AAAA,EACF;AAAA,EACD,WAAQ;AACNA,kBAAAA,MAAI,KAAK,aAAa,KAAK,cAAc;AAAA,EAC1C;AAAA,EACD,SAAS;AAAA,IACP,WAAW,OAAc;AACvB,UAAI,KAAK,iBAAiB,SAAS,SAAS,KAAK,KAAK,gBAAgB,MAAM;AAE1E,aAAK,eAAe;AACnB,aAAK,MAAM,MAAM,EAA+B,YAAY,aAAa,CAAC;AAAA,MAC7E,WACS,SAAQ,GAAE;AAEjB,aAAK,eAAe;AAAA,MACtB,WACS,SAAS,KAAK,KAAK,iBAAgB,GAAE;AAE5C,aAAK,eAAe,KAAK,cAAc,KAAK;AAAA,MAC9C;AACA,WAAK,iBAAiB,KAAK;AAAA,IAK5B;AAAA,IACD,eAAe,KAAY;AAEzB,WAAK,eAAe,MAAM,KAAK;AAC/B,WAAK,cAAc;AAAA,IACpB;AAAA,IACD,iBAAiB,OAAc;AAC7B,UAAI,KAAK,kBAAkB,OAAO;AAChC,eAAK;AAAA,MACP;AACA,UAAI,CAAC,KAAK,QAAQ,KAAK,EAAE,MAAM;AAC7B,aAAK,QAAQ,KAAK,EAAE,OAAO;AAAA,MAC7B;AACA,WAAK,gBAAgB;AAAA,IACtB;AAAA,IACD,cAAW;AACTA,0BAAI,UAAU,IAAA,cAAA;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,YAAY;AAAA,MACb,CAAA,CAAA;AAAA,IACH;AAAA,EACF;CACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9HF,GAAG,WAAW,eAAe;"}
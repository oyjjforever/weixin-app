"use strict";const e=require("../../common/vendor.js");if(!Array){e.resolveComponent("uni-icons")()}Math||(t+(()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js"))();const t=()=>"../../components/NoticeSwiper.js",n=e.defineComponent({__name:"index",setup(t){const n=e.ref([]),i=e.ref([]),a=e.ref([]),o=e.ref(!1),l=async()=>{try{const t=await e.nr.callFunction({name:"getNoticeList",data:{limit:5}});0===t.result.code&&(a.value=t.result.data.notices||[])}catch(t){console.error("获取通知列表失败:",t)}},s=async()=>{o.value=!0;try{const t=await e.nr.callFunction({name:"getProductList",data:{page:1,pageSize:20}});if(0===t.result.code){const{products:e,banners:a}=t.result.data;i.value=e||[],n.value=a||[]}else e.index.showToast({title:t.result.message||"获取数据失败",icon:"none"})}catch(t){console.error("获取产品列表失败:",t),e.index.showToast({title:"网络错误，请重试",icon:"none"})}finally{o.value=!1}};e.onMounted((()=>{l(),s()}));const c=t=>{const{linkType:n,linkUrl:i,_id:a}=t;switch(n){case"page":e.index.navigateTo({url:i,fail:()=>{e.index.switchTab({url:i,fail:()=>{e.index.showToast({title:"页面跳转失败",icon:"none"})}})}});break;case"url":e.index.showModal({title:"提示",content:"是否在浏览器中打开链接？",success:e=>{e.confirm&&plus.runtime.openURL(i)}});break;case"product":e.index.navigateTo({url:`/pages/index/detail?id=${i}`,fail:()=>{e.index.showToast({title:"产品详情跳转失败",icon:"none"})}});break;default:e.index.navigateTo({url:`/pages/notice/detail?id=${a}`,fail:()=>{e.index.showToast({title:"通知详情跳转失败",icon:"none"})}})}},r=()=>{l(),s()};return(t,l)=>e.e({a:e.o(c),b:e.p({noticeList:a.value}),c:n.value.length>0},n.value.length>0?{d:e.f(n.value,((t,n,i)=>({a:t.image,b:e.t(t.title),c:e.t(t.description),d:n})))}:o.value?{}:{f:e.p({type:"image",size:"48",color:"#d9d9d9"})},{e:!o.value,g:e.f(i.value,((t,n,i)=>({a:t.image,b:e.t(t.name),c:e.t(t.description),d:e.t(t.difficulty),e:"0a57c708-2-"+i,f:e.t(t.rating),g:n,h:e.o((n=>{return i=t,void e.index.navigateTo({url:`/pages/index/detail?id=${i._id||i.id}`});var i}),n)}))),h:e.p({type:"star",size:"14",color:"#ff4757"}),i:0===i.value.length&&!o.value},0!==i.value.length||o.value?{}:{j:e.p({type:"shop",size:"64",color:"#d9d9d9"}),k:e.o(r)},{l:o.value},o.value?{m:e.p({type:"spinner-cycle",size:"32",color:"#999"})}:{})}});wx.createPage(n);

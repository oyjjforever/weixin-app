"use strict";const e=require("../../common/vendor.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const a=e.defineComponent({__name:"detail",setup(a){const t=e.ref(!1),o=e.ref(!1),i=e.ref(!1),r=e.ref(""),n=e.ref({}),s=e.ref([]),l=e.ref([]),u=e.ref([]),c=e.ref([]),g=e.ref([]),f=e.ref(4.8),d=e.ref([]),v=e.ref([]),m=()=>{e.index.showToast({title:"正在连接设计师",icon:"loading"})},p=()=>{e.index.showToast({title:"查看更多评价",icon:"none"})},h=()=>{e.index.pageScrollTo({scrollTop:0,duration:300})};return e.onMounted((()=>{const a=getCurrentPages(),o=a[a.length-1].options;o&&o.id&&(r.value=o.id,(async a=>{if(a){i.value=!0;try{const o=await e.nr.callFunction({name:"getCaseDetail",data:{id:a}});if(0===o.result.code){const e=o.result.data;n.value={title:e.title,roomType:e.roomType,area:e.area,style:e.style,ownerIntro:e.ownerIntro},e.mainImages&&e.mainImages.length>0&&(s.value=e.mainImages),e.sceneImages&&e.sceneImages.length>0&&(l.value=e.sceneImages),e.furnitureCategories&&e.furnitureCategories.length>0&&(u.value=e.furnitureCategories),e.designerSuggestions&&e.designerSuggestions.length>0&&(c.value=e.designerSuggestions),e.colorPalette&&e.colorPalette.length>0&&(g.value=e.colorPalette),e.overallRating&&(f.value=e.overallRating),e.userReviews&&e.userReviews.length>0&&(d.value=e.userReviews),e.similarCases&&e.similarCases.length>0&&(v.value=e.similarCases),void 0!==e.isFavorite&&(t.value=e.isFavorite)}else e.index.showToast({title:o.result.message||"获取案例详情失败",icon:"none"})}catch(o){console.error("获取案例详情失败:",o),e.index.showToast({title:"网络错误，请重试",icon:"none"})}finally{i.value=!1}}})(o.id))})),(a,t)=>({a:e.f(s.value,((e,a,t)=>({a:e,b:a}))),b:e.t(n.value.title),c:e.t(n.value.roomType),d:e.t(n.value.area),e:e.t(n.value.style),f:e.t(n.value.ownerIntro),g:e.f(l.value,((a,t,o)=>e.e({a:a.image,b:a.productTag},a.productTag?{c:e.t(a.productTag)}:{},{d:t,e:e.o((a=>(a=>{const t=l.value.map((e=>e.image));e.index.previewImage({urls:t,current:t[a]})})(t)),t)}))),h:e.f(u.value,((a,t,o)=>({a:e.t(a.name),b:e.f(a.products,((a,t,o)=>({a:a.image,b:e.t(a.name),c:e.t(a.description),d:e.t(a.price),e:t,f:e.o((t=>(a=>{a.id?e.index.navigateTo({url:`/pages/index/detail?id=${a.id}`}):e.index.showToast({title:"产品信息不完整",icon:"none"})})(a)),t)}))),c:t}))),i:e.f(c.value,((a,t,o)=>({a:e.t(a),b:t}))),j:e.f(g.value,((a,t,o)=>({a:e.t(a.name),b:t,c:a.hex}))),k:e.p({type:"star-filled",size:"16",color:"#FFB800"}),l:e.t(f.value),m:e.f(d.value,((a,t,o)=>e.e({a:a.avatar,b:e.t(a.username),c:e.f(5,((t,i,r)=>({a:t,b:"1447c843-1-"+o+"-"+r,c:e.p({type:t<=a.rating?"star-filled":"star",size:"12",color:"#FFB800"})}))),d:e.t(a.content),e:a.images},a.images?{f:e.f(a.images,((t,o,i)=>({a:o,b:t,c:e.o((t=>((a,t)=>{e.index.previewImage({urls:a,current:a[t]})})(a.images,o)),o)})))}:{},{g:t}))),n:e.o(p),o:e.p({type:"chat",size:"20",color:"#ffffff"}),p:e.o(m),q:e.p({type:"up",size:"24",color:"#ffffff"}),r:o.value,s:e.o(h)})}});wx.createPage(a);

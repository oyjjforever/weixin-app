"use strict";const e=require("../../common/vendor.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const n=e.defineComponent({__name:"detail",setup(n){const t=e.ref(null),a=e.ref(!1),o=e=>{if(!e)return"";const n=new Date(e);return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`},i=n=>{if(!n)return;const t=Array.isArray(n)?n:[n],a=Array.isArray(n)?n[0]:n;e.index.previewImage({urls:t,current:a})},l=()=>{console.log("图片加载成功")},r=n=>{console.error("图片加载失败:",n),e.index.showToast({title:"图片加载失败",icon:"none"})},s=()=>{if(!t.value)return;const{linkType:n,linkUrl:a}=t.value;if(a)switch(n){case"page":e.index.navigateTo({url:a,fail:()=>{e.index.switchTab({url:a,fail:()=>{e.index.showToast({title:"页面跳转失败",icon:"none"})}})}});break;case"url":e.index.showModal({title:"提示",content:"是否在浏览器中打开链接？",success:e=>{e.confirm&&plus.runtime.openURL(a)}});break;case"product":e.index.navigateTo({url:`/pages/index/detail?id=${a}`,fail:()=>{e.index.showToast({title:"产品详情跳转失败",icon:"none"})}})}else e.index.showToast({title:"链接地址无效",icon:"none"})},u=()=>{e.index.navigateBack()};return e.onMounted((()=>{const n=getCurrentPages(),o=n[n.length-1].options;o&&o.id?(async n=>{a.value=!0;try{const o=await e.nr.callFunction({name:"getNoticeDetail",data:{id:n}});0===o.result.code?t.value=o.result.data:e.index.showToast({title:o.result.message||"获取通知详情失败",icon:"none"})}catch(o){console.error("获取通知详情失败:",o),e.index.showToast({title:"网络错误，请重试",icon:"none"})}finally{a.value=!1}})(o.id):e.index.showToast({title:"缺少通知ID",icon:"none"})})),(n,c)=>{return e.e({a:t.value},t.value?e.e({b:e.t((v=t.value.type,{promotion:"促销活动",announcement:"公告",maintenance:"维护通知"}[v]||"通知")),c:e.n("type-"+t.value.type),d:e.t(t.value.title),e:t.value.endTime},t.value.endTime?{f:e.t(o(t.value.startTime)),g:e.t(o(t.value.endTime))}:{},{h:t.value.image},t.value.image?e.e({i:!Array.isArray(t.value.image)},Array.isArray(t.value.image)?{n:e.f(t.value.image,((n,t,a)=>({a:n,b:e.o((e=>i(n)),t),c:e.o(r,t),d:e.o(l,t),e:t})))}:{j:t.value.image,k:e.o(i),l:e.o(r),m:e.o(l)}):{},{o:e.t(t.value.content),p:t.value.linkType&&"none"!==t.value.linkType},t.value.linkType&&"none"!==t.value.linkType?{q:e.t((d=t.value.linkType,{page:"查看详情",url:"访问链接",product:"查看产品"}[d]||"了解更多")),r:e.p({type:"right",size:"18",color:"#ffffff"}),s:e.o(s)}:{}):a.value?{v:e.p({type:"spinner-cycle",size:"48",color:"#999"})}:{w:e.p({type:"info",size:"64",color:"#d9d9d9"}),x:e.o(u)},{t:a.value});var d,v}}}),t=e._export_sfc(n,[["__scopeId","data-v-ee106d93"]]);wx.createPage(t);

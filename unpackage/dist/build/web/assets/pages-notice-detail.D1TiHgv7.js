import{d as e,r as a,l as t,x as l,s as n,a as s,o as i,c as o,w as c,b as r,h as u,t as d,n as f,g as p,e as y,f as m,F as _,m as g,y as v,p as k,q as h,K as x,j as b,i as w,v as T,S as A,k as C}from"./index-H1zobiUJ.js";import{r as F,_ as S,a as D}from"./uni-app.es.B9r4ma60.js";const $=D(e({__name:"detail",setup(e){const D=a(null),$=a(!1),j=e=>{if(!e)return"";const a=new Date(e);return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")}`},z=e=>{if(!e)return;const a=Array.isArray(e)?e:[e],t=Array.isArray(e)?e[0]:e;v({urls:a,current:t})},E=()=>{console.log("图片加载成功")},I=e=>{console.error("图片加载失败:",e),n({title:"图片加载失败",icon:"none"})},L=()=>{if(!D.value)return;const{linkType:e,linkUrl:a}=D.value;if(a)switch(e){case"page":k({url:a,fail:()=>{h({url:a,fail:()=>{n({title:"页面跳转失败",icon:"none"})}})}});break;case"url":window.open(a,"_blank");break;case"product":k({url:`/pages/index/detail?id=${a}`,fail:()=>{n({title:"产品详情跳转失败",icon:"none"})}})}else n({title:"链接地址无效",icon:"none"})},q=()=>{x()};return t((()=>{const e=l(),a=e[e.length-1].options;a&&a.id?(async e=>{$.value=!0;try{const a=await g.callFunction({name:"getNoticeDetail",data:{id:e}});0===a.result.code?D.value=a.result.data:n({title:a.result.message||"获取通知详情失败",icon:"none"})}catch(a){console.error("获取通知详情失败:",a),n({title:"网络错误，请重试",icon:"none"})}finally{$.value=!1}})(a.id):n({title:"缺少通知ID",icon:"none"})})),(e,a)=>{const t=b,l=w,n=T,g=C,v=A,k=F(s("uni-icons"),S);return i(),o(l,{class:"container"},{default:c((()=>[D.value?(i(),o(l,{key:0,class:"content-container"},{default:c((()=>[r(l,{class:f(["type-badge","type-"+D.value.type])},{default:c((()=>[r(t,null,{default:c((()=>{return[u(d((e=D.value.type,{promotion:"促销活动",announcement:"公告",maintenance:"维护通知"}[e]||"通知")),1)];var e})),_:1})])),_:1},8,["class"]),r(l,{class:"title-section"},{default:c((()=>[r(t,{class:"notice-title"},{default:c((()=>[u(d(D.value.title),1)])),_:1}),r(l,{class:"notice-meta"},{default:c((()=>[D.value.endTime?(i(),o(t,{key:0,class:"valid-time"},{default:c((()=>[u(" 有效期："+d(j(D.value.startTime))+" ~ "+d(j(D.value.endTime)),1)])),_:1})):p("",!0)])),_:1})])),_:1}),D.value.image?(i(),o(l,{key:0,class:"image-section"},{default:c((()=>[Array.isArray(D.value.image)?(i(),o(v,{key:1,class:"image-swiper",autoplay:!1,circular:!1,"indicator-dots":!0,"indicator-color":"rgba(255,255,255,0.5)","indicator-active-color":"#4facfe",style:{height:"700rpx"}},{default:c((()=>[(i(!0),y(_,null,m(D.value.image,((e,a)=>(i(),o(g,{key:a},{default:c((()=>[r(n,{src:e,mode:"widthFix",class:"notice-image",onClick:a=>z(e),onError:I,onLoad:E},null,8,["src","onClick"])])),_:2},1024)))),128))])),_:1})):(i(),o(n,{key:0,src:D.value.image,mode:"widthFix",class:"notice-image",onClick:z,onError:I,onLoad:E},null,8,["src"]))])),_:1})):p("",!0),r(l,{class:"content-section"},{default:c((()=>[r(t,{class:"content-text"},{default:c((()=>[u(d(D.value.content),1)])),_:1})])),_:1}),D.value.linkType&&"none"!==D.value.linkType?(i(),o(l,{key:1,class:"action-section"},{default:c((()=>[r(l,{class:"action-btn",onClick:L},{default:c((()=>[r(t,null,{default:c((()=>{return[u(d((e=D.value.linkType,{page:"查看详情",url:"访问链接",product:"查看产品"}[e]||"了解更多")),1)];var e})),_:1}),r(k,{type:"right",size:"18",color:"#ffffff"})])),_:1})])),_:1})):p("",!0)])),_:1})):$.value?(i(),o(l,{key:1,class:"loading-state"},{default:c((()=>[r(k,{type:"spinner-cycle",size:"48",color:"#999"}),r(t,{class:"loading-text"},{default:c((()=>[u("加载中...")])),_:1})])),_:1})):(i(),o(l,{key:2,class:"empty-state"},{default:c((()=>[r(k,{type:"info",size:"64",color:"#d9d9d9"}),r(t,{class:"empty-text"},{default:c((()=>[u("通知不存在或已被删除")])),_:1}),r(l,{class:"back-btn",onClick:q},{default:c((()=>[r(t,null,{default:c((()=>[u("返回")])),_:1})])),_:1})])),_:1}))])),_:1})}}}),[["__scopeId","data-v-909959ec"]]);export{$ as default};
